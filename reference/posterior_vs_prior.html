<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Juxtapose prior and posterior — posterior_vs_prior • rstanarm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Juxtapose prior and posterior — posterior_vs_prior" />

<meta property="og:description" content="Plot medians and central intervals comparing parameter draws from the prior 
and posterior distributions. If the plotted priors look different than the 
priors you think you specified it is likely either because of internal 
rescaling or the use of the QR argument (see the documentation for the
prior_summary method for details on 
these special cases)." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstanarm</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.17.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../dev-notes/index.html">Develop</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/rstanarm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Juxtapose prior and posterior</h1>
    
    <div class="hidden name"><code>posterior_vs_prior.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Plot medians and central intervals comparing parameter draws from the prior 
and posterior distributions. If the plotted priors look different than the 
priors you think you specified it is likely either because of internal 
rescaling or the use of the <code>QR</code> argument (see the documentation for the
<code><a href='prior_summary.stanreg.html'>prior_summary</a></code> method for details on 
these special cases).</p>
    
    </div>

    <pre class="usage"><span class='fu'>posterior_vs_prior</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for stanreg</span>
<span class='fu'>posterior_vs_prior</span>(<span class='no'>object</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>regex_pars</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>color_by</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"parameter"</span>, <span class='st'>"vs"</span>, <span class='st'>"none"</span>),
  <span class='kw'>group_by_parameter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>facet_args</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A fitted model object returned by one of the 
<span class="pkg">rstanarm</span> modeling functions. See <code><a href='stanreg-objects.html'>stanreg-objects</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>The S3 generic uses <code>...</code> to pass arguments to any defined 
methods. For the method for stanreg objects, <code>...</code> is for arguments
(other than <code>color</code>) passed to <code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_linerange'>geom_pointrange</a></code>
to control the appearance of the plotted intervals.</p></td>
    </tr>
    <tr>
      <th>pars</th>
      <td><p>An optional character vector specifying a subset of parameters to
display. Parameters can be specified by name or several shortcuts can be 
used. Using <code>pars="beta"</code> will restrict the displayed parameters to 
only the regression coefficients (without the intercept). <code>"alpha"</code> 
can also be used as a shortcut for <code>"(Intercept)"</code>. If the model has 
varying intercepts and/or slopes they can be selected using <code>pars = 
"varying"</code>.</p>
<p>In addition, for <code>stanmvreg</code> objects there are some additional shortcuts 
available. Using <code>pars = "long"</code> will display the 
parameter estimates for the longitudinal submodels only (excluding group-specific
pparameters, but including auxiliary parameters).
Using <code>pars = "event"</code> will display the 
parameter estimates for the event submodel only, including any association
parameters. 
Using <code>pars = "assoc"</code> will display only the 
association parameters. 
Using <code>pars = "fixef"</code> will display all fixed effects, but not
the random effects or the auxiliary parameters. 
 <code>pars</code> and <code>regex_pars</code> are set to <code>NULL</code> then all 
fixed effect regression coefficients are selected, as well as any 
auxiliary parameters and the log posterior.</p>
<p>If <code>pars</code> is <code>NULL</code> all parameters are selected for a <code>stanreg</code>
object, while for a <code>stanmvreg</code> object all 
fixed effect regression coefficients are selected as well as any 
auxiliary parameters and the log posterior. See 
<strong>Examples</strong>.</p></td>
    </tr>
    <tr>
      <th>regex_pars</th>
      <td><p>An optional character vector of regular 
expressions to use for parameter selection. <code>regex_pars</code> can be used
in place of <code>pars</code> or in addition to <code>pars</code>. Currently, all
functions that accept a <code>regex_pars</code> argument ignore it for models fit
using optimization.</p></td>
    </tr>
    <tr>
      <th>prob</th>
      <td><p>A number \(p \in (0,1)\) indicating the desired 
posterior probability mass to include in the (central posterior) interval 
estimates displayed in the plot. The default is \(0.9\).</p></td>
    </tr>
    <tr>
      <th>color_by</th>
      <td><p>How should the estimates be colored? Use <code>"parameter"</code> 
to color by parameter name, <code>"vs"</code> to color the prior one color and 
the posterior another, and <code>"none"</code> to use no color. Except when 
<code>color_by="none"</code>, a variable is mapped to the color 
<code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></code>thetic and it is therefore also possible to
change the default colors by adding one of the various discrete color
scales available in <code>ggplot2</code> 
(<code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/scale_manual'>scale_color_manual</a></code>, 
<code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/scale_brewer'>scale_color_brewer</a></code>, etc.). See Examples.</p></td>
    </tr>
    <tr>
      <th>group_by_parameter</th>
      <td><p>Should estimates be grouped together by parameter
(<code>TRUE</code>) or by posterior and prior (<code>FALSE</code>, the default)?</p></td>
    </tr>
    <tr>
      <th>facet_args</th>
      <td><p>A named list of arguments passed to
<code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap'>facet_wrap</a></code> (other than the <code>facets</code> argument),
e.g., <code>nrow</code> or <code>ncol</code> to change the layout, <code>scales</code> to 
allow axis scales to vary across facets, etc. See Examples.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A ggplot object that can be further customized using the 
  <span class="pkg">ggplot2</span> package.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gabry, J., Simpson, D., Vehtari, A., Betancourt, M., and Gelman,
  A. (2018). Visualization in Bayesian workflow. <em>Journal of the Royal
  Statistical Society Series A</em>, accepted for publication. arXiv preprint:
  <a href='http://arxiv.org/abs/1709.01449'>http://arxiv.org/abs/1709.01449</a>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='kw'>if</span> (!<span class='fu'>exists</span>(<span class='st'>"example_model"</span>)) <span class='fu'>example</span>(<span class='no'>example_model</span>)
<span class='co'># display non-varying (i.e. not group-level) coefficients</span>
<span class='fu'>posterior_vs_prior</span>(<span class='no'>example_model</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='st'>"beta"</span>)

<span class='co'># show group-level (varying) parameters and group by parameter</span>
<span class='fu'>posterior_vs_prior</span>(<span class='no'>example_model</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='st'>"varying"</span>,
                   <span class='kw'>group_by_parameter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>color_by</span> <span class='kw'>=</span> <span class='st'>"vs"</span>)

<span class='co'># group by parameter and allow axis scales to vary across facets</span>
<span class='fu'>posterior_vs_prior</span>(<span class='no'>example_model</span>, <span class='kw'>regex_pars</span> <span class='kw'>=</span> <span class='st'>"period"</span>,
                   <span class='kw'>group_by_parameter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>color_by</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
                   <span class='kw'>facet_args</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>scales</span> <span class='kw'>=</span> <span class='st'>"free"</span>))

<span class='co'># assign to object and customize with functions from ggplot2</span>
(<span class='no'>gg</span> <span class='kw'>&lt;-</span> <span class='fu'>posterior_vs_prior</span>(<span class='no'>example_model</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"beta"</span>, <span class='st'>"varying"</span>), <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.8</span>))

<span class='no'>gg</span> +
 <span class='kw pkg'>ggplot2</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_abline'>geom_hline</a></span>(<span class='kw'>yintercept</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.3</span>, <span class='kw'>linetype</span> <span class='kw'>=</span> <span class='fl'>3</span>) +
 <span class='kw pkg'>ggplot2</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/coord_flip'>coord_flip</a></span>() +
 <span class='kw pkg'>ggplot2</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>ggtitle</a></span>(<span class='st'>"Comparing the prior and posterior"</span>)

<span class='co'># compare very wide and very narrow priors using roaches example</span>
<span class='co'># (see help(roaches, "rstanarm") for info on the dataset)</span>
<span class='no'>roaches</span>$<span class='no'>roach100</span> <span class='kw'>&lt;-</span> <span class='no'>roaches</span>$<span class='no'>roach1</span> / <span class='fl'>100</span>
<span class='no'>wide_prior</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='priors.html'>normal</a></span>(<span class='fl'>0</span>, <span class='fl'>10</span>)
<span class='no'>narrow_prior</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='priors.html'>normal</a></span>(<span class='fl'>0</span>, <span class='fl'>0.1</span>)
<span class='no'>fit_pois_wide_prior</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stan_glm.html'>stan_glm</a></span>(<span class='no'>y</span> ~ <span class='no'>treatment</span> + <span class='no'>roach100</span> + <span class='no'>senior</span>,
                                <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fu'>log</span>(<span class='no'>exposure2</span>),
                                <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"poisson"</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>roaches</span>,
                                <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>wide_prior</span>)
<span class='fu'>posterior_vs_prior</span>(<span class='no'>fit_pois_wide_prior</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='st'>"beta"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
                   <span class='kw'>group_by_parameter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>color_by</span> <span class='kw'>=</span> <span class='st'>"vs"</span>,
                   <span class='kw'>facet_args</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>scales</span> <span class='kw'>=</span> <span class='st'>"free"</span>))

<span class='no'>fit_pois_narrow_prior</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>fit_pois_wide_prior</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>narrow_prior</span>)
<span class='fu'>posterior_vs_prior</span>(<span class='no'>fit_pois_narrow_prior</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='st'>"beta"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
                   <span class='kw'>group_by_parameter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>color_by</span> <span class='kw'>=</span> <span class='st'>"vs"</span>,
                   <span class='kw'>facet_args</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>scales</span> <span class='kw'>=</span> <span class='st'>"free"</span>))


<span class='co'># look at cutpoints for ordinal model</span>
<span class='no'>fit_polr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stan_polr.html'>stan_polr</a></span>(<span class='no'>tobgp</span> ~ <span class='no'>agegp</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>esoph</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"probit"</span>,
                      <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>R2</a></span>(<span class='fl'>0.2</span>, <span class='st'>"mean"</span>), <span class='kw'>init_r</span> <span class='kw'>=</span> <span class='fl'>0.1</span>)
(<span class='no'>gg_polr</span> <span class='kw'>&lt;-</span> <span class='fu'>posterior_vs_prior</span>(<span class='no'>fit_polr</span>, <span class='kw'>regex_pars</span> <span class='kw'>=</span> <span class='st'>"\\|"</span>, <span class='kw'>color_by</span> <span class='kw'>=</span> <span class='st'>"vs"</span>,
                               <span class='kw'>group_by_parameter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))
<span class='co'># flip the x and y axes</span>
<span class='no'>gg_polr</span> + <span class='kw pkg'>ggplot2</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/coord_flip'>coord_flip</a></span>()
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

