<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian generalized linear models with group-specific terms via Stan — stan_glmer • rstanarm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bayesian generalized linear models with group-specific terms via Stan — stan_glmer" />

<meta property="og:description" content="
Bayesian inference for GLMs with group-specific coefficients that have 
unknown covariance matrices with flexible priors." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstanarm</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.17.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../dev-notes/index.html">Develop</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/rstanarm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian generalized linear models with group-specific terms via Stan</h1>
    
    <div class="hidden name"><code>stan_glmer.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><img src='figures/stanlogo.png' width="25px" alt="http://mc-stan.org/about/logo/" />
Bayesian inference for GLMs with group-specific coefficients that have 
unknown covariance matrices with flexible priors.</p>
    
    </div>

    <pre class="usage"><span class='fu'>stan_glmer</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>gaussian</span>, <span class='no'>subset</span>, <span class='no'>weights</span>,
  <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='fu'>getOption</span>(<span class='st'>"na.action"</span>, <span class='st'>"na.omit"</span>), <span class='no'>offset</span>, <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>exponential</a></span>(), <span class='kw'>prior_covariance</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>decov</a></span>(), <span class='kw'>prior_PD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sampling"</span>, <span class='st'>"meanfield"</span>, <span class='st'>"fullrank"</span>), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>stan_lmer</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>subset</span>, <span class='no'>weights</span>,
  <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='fu'>getOption</span>(<span class='st'>"na.action"</span>, <span class='st'>"na.omit"</span>), <span class='no'>offset</span>, <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>exponential</a></span>(), <span class='kw'>prior_covariance</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>decov</a></span>(), <span class='kw'>prior_PD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sampling"</span>, <span class='st'>"meanfield"</span>, <span class='st'>"fullrank"</span>), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>stan_glmer.nb</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>subset</span>, <span class='no'>weights</span>,
  <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='fu'>getOption</span>(<span class='st'>"na.action"</span>, <span class='st'>"na.omit"</span>), <span class='no'>offset</span>, <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"log"</span>, <span class='no'>...</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>exponential</a></span>(), <span class='kw'>prior_covariance</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>decov</a></span>(), <span class='kw'>prior_PD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sampling"</span>, <span class='st'>"meanfield"</span>, <span class='st'>"fullrank"</span>), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula, data</th>
      <td><p>Same as for <code><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></code>. <em>We
strongly advise against omitting the <code>data</code> argument</em>. Unless 
<code>data</code> is specified (and is a data frame) many post-estimation 
functions (including <code>update</code>, <code>loo</code>, <code>kfold</code>) are not 
guaranteed to work properly.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Same as for <code><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></code> except it is also
possible to use <code>family=mgcv::betar</code> to estimate a Beta regression
with <code>stan_glmer</code>.</p></td>
    </tr>
    <tr>
      <th>subset, weights, offset</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>.</p></td>
    </tr>
    <tr>
      <th>na.action, contrasts</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>, but rarely 
specified.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>stan_glmer</code>, further arguments passed to 
<code><a href='http://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-sampling'>sampling</a></code> (e.g. <code>iter</code>, <code>chains</code>, 
<code>cores</code>, etc.) or to <code><a href='http://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-vb'>vb</a></code> (if <code>algorithm</code> is 
<code>"meanfield"</code> or <code>"fullrank"</code>). For <code>stan_lmer</code> and 
<code>stan_glmer.nb</code>, <code>...</code> should also contain all relevant arguments
to pass to <code>stan_glmer</code> (except <code>family</code>).</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>The prior distribution for the regression coefficients. 
<code>prior</code> should be a call to one of the various functions provided by 
<span class="pkg">rstanarm</span> for specifying priors. The subset of these functions that 
can be used for the prior on the coefficients can be grouped into several 
"families":</p>
<table class='table'>
<tr><td><strong>Family</strong></td><td><strong>Functions</strong></td></tr>
<tr><td><em>Student t family</em></td><td><code>normal</code>, <code>student_t</code>, <code>cauchy</code></td></tr>
<tr><td><em>Hierarchical shrinkage family</em></td><td><code>hs</code>, <code>hs_plus</code></td></tr>
<tr><td><em>Laplace family</em></td><td><code>laplace</code>, <code>lasso</code></td></tr>
<tr><td><em>Product normal family</em></td><td><code>product_normal</code></td></tr>
</table>


<p>See the <a href='priors.html'>priors help page</a> for details on the families and 
how to specify the arguments for all of the functions in the table above.
To omit a prior ---i.e., to use a flat (improper) uniform prior---
<code>prior</code> can be set to <code>NULL</code>, although this is rarely a good
idea.</p>
<p><strong>Note:</strong> Unless <code>QR=TRUE</code>, if <code>prior</code> is from the Student t
family or Laplace family, and if the <code>autoscale</code> argument to the 
function used to specify the prior (e.g. <code><a href='priors.html'>normal</a></code>) is left at 
its default and recommended value of <code>TRUE</code>, then the default or 
user-specified prior scale(s) may be adjusted internally based on the
scales of the predictors. See the <a href='priors.html'>priors help page</a> and the
<em>Prior Distributions</em> vignette for details on the rescaling and the
<code><a href='prior_summary.stanreg.html'>prior_summary</a></code> function for a summary of the priors used for a
particular model.</p></td>
    </tr>
    <tr>
      <th>prior_intercept</th>
      <td><p>The prior distribution for the intercept. 
<code>prior_intercept</code> can be a call to <code>normal</code>, <code>student_t</code> or 
<code>cauchy</code>. See the <a href='priors.html'>priors help page</a> for details on 
these functions. To omit a prior on the intercept ---i.e., to use a flat
(improper) uniform prior--- <code>prior_intercept</code> can be set to
<code>NULL</code>.</p>
<p><strong>Note:</strong> If using a dense representation of the design matrix
---i.e., if the <code>sparse</code> argument is left at its default value of
<code>FALSE</code>--- then the prior distribution for the intercept is set so it
applies to the value <em>when all predictors are centered</em>. If you prefer
to specify a prior on the intercept without the predictors being
auto-centered, then you have to omit the intercept from the
<code><a href='http://www.rdocumentation.org/packages/stats/topics/formula'>formula</a></code> and include a column of ones as a predictor,
in which case some element of <code>prior</code> specifies the prior on it,
rather than <code>prior_intercept</code>. Regardless of how
<code>prior_intercept</code> is specified, the reported <em>estimates</em> of the
intercept always correspond to a parameterization without centered
predictors (i.e., same as in <code>glm</code>).</p></td>
    </tr>
    <tr>
      <th>prior_aux</th>
      <td><p>The prior distribution for the "auxiliary" parameter (if
applicable). The "auxiliary" parameter refers to a different parameter 
depending on the <code>family</code>. For Gaussian models <code>prior_aux</code> 
controls <code>"sigma"</code>, the error 
standard deviation. For negative binomial models <code>prior_aux</code> controls 
<code>"reciprocal_dispersion"</code>, which is similar to the 
<code>"size"</code> parameter of <code><a href='http://www.rdocumentation.org/packages/stats/topics/NegBinomial'>rnbinom</a></code>:
smaller values of <code>"reciprocal_dispersion"</code> correspond to 
greater dispersion. For gamma models <code>prior_aux</code> sets the prior on 
to the <code>"shape"</code> parameter (see e.g., 
<code><a href='http://www.rdocumentation.org/packages/stats/topics/GammaDist'>rgamma</a></code>), and for inverse-Gaussian models it is the 
so-called <code>"lambda"</code> parameter (which is essentially the reciprocal of
a scale parameter). Binomial and Poisson models do not have auxiliary 
parameters.</p>
<p><code>prior_aux</code> can be a call to <code>exponential</code> to 
use an exponential distribution, or <code>normal</code>, <code>student_t</code> or 
<code>cauchy</code>, which results in a half-normal, half-t, or half-Cauchy 
prior. See <code><a href='priors.html'>priors</a></code> for details on these functions. To omit a 
prior ---i.e., to use a flat (improper) uniform prior--- set 
<code>prior_aux</code> to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>prior_covariance</th>
      <td><p>Cannot be <code>NULL</code>; see <code><a href='priors.html'>decov</a></code> for
more information about the default arguments.</p></td>
    </tr>
    <tr>
      <th>prior_PD</th>
      <td><p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to draw from the prior predictive distribution instead of
conditioning on the outcome.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>A string (possibly abbreviated) indicating the 
estimation approach to use. Can be <code>"sampling"</code> for MCMC (the
default), <code>"optimizing"</code> for optimization, <code>"meanfield"</code> for
variational inference with independent normal distributions, or
<code>"fullrank"</code> for variational inference with a multivariate normal
distribution. See <code><a href='rstanarm-package.html'>rstanarm-package</a></code> for more details on the
estimation algorithms. NOTE: not all fitting functions support all four
algorithms.</p></td>
    </tr>
    <tr>
      <th>adapt_delta</th>
      <td><p>Only relevant if <code>algorithm="sampling"</code>. See 
the <a href='adapt_delta.html'>adapt_delta</a> help page for details.</p></td>
    </tr>
    <tr>
      <th>QR</th>
      <td><p>A logical scalar defaulting to <code>FALSE</code>, but if <code>TRUE</code>
applies a scaled <code>qr</code> decomposition to the design matrix. The
transformation does not change the likelihood of the data but is
recommended for computational reasons when there are multiple predictors.
See the <a href='QR-argument.html'>QR-argument</a> documentation page for details on how
<span class="pkg">rstanarm</span> does the transformation and important information about how
to interpret the prior distributions of the model parameters when using
<code>QR=TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>sparse</th>
      <td><p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to use a sparse representation of the design (X) matrix. 
If <code>TRUE</code>, the the design matrix is not centered (since that would 
destroy the sparsity) and likewise it is not possible to specify both 
<code>QR = TRUE</code> and <code>sparse = TRUE</code>. Depending on how many zeros
there are in the design matrix, setting <code>sparse = TRUE</code> may make
the code run faster and can consume much less RAM.</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>For <code>stan_glmer.nb</code> only, the link function to use. See 
<code><a href='neg_binomial_2.html'>neg_binomial_2</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='stanreg-objects.html'>stanreg</a> object is returned 
for <code>stan_glmer, stan_lmer, stan_glmer.nb</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>stan_glmer</code> function is similar in syntax to 
  <code><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></code> but rather than performing (restricted) maximum 
  likelihood estimation of generalized linear models, Bayesian estimation is 
  performed via MCMC. The Bayesian model adds priors on the 
  regression coefficients (in the same way as <code><a href='stan_glm.html'>stan_glm</a></code>) and
  priors on the terms of a decomposition of the covariance matrices of the
  group-specific parameters. See <code><a href='priors.html'>priors</a></code> for more information
  about the priors.</p>  
<p>The <code>stan_lmer</code> function is equivalent to <code>stan_glmer</code> with 
  <code>family = gaussian(link = "identity")</code>.</p>  
<p>The <code>stan_glmer.nb</code> function, which takes the extra argument 
  <code>link</code>, is a wrapper for <code>stan_glmer</code> with <code>family = 
  <a href='neg_binomial_2.html'>neg_binomial_2</a>(link)</code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gelman, A. and Hill, J. (2007). <em>Data Analysis Using
  Regression and Multilevel/Hierarchical Models.</em> Cambridge University Press,
  Cambridge, UK. (Ch. 11-15)</p>
<p>Muth, C., Oravecz, Z., and Gabry, J. (2018)
User-friendly Bayesian regression modeling: A tutorial with rstanarm and shinystan.
<em>The Quantitative Methods for Psychology</em>. 14(2), 99--119.
<a href='https://www.tqmp.org/RegularArticles/vol14-2/p099/p099.pdf'>https://www.tqmp.org/RegularArticles/vol14-2/p099/p099.pdf</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='stanreg-methods.html'>stanreg-methods</a></code> and 
<code><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></code>.</p>
<p>The vignette for <code>stan_glmer</code> and the <em>Hierarchical 
  Partial Pooling</em> vignette. <a href='http://mc-stan.org/rstanarm/articles/'>http://mc-stan.org/rstanarm/articles/</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># see help(example_model) for details on the model below</span>
<span class='kw'>if</span> (!<span class='fu'>exists</span>(<span class='st'>"example_model"</span>)) <span class='fu'>example</span>(<span class='no'>example_model</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: no help found for ‘example_model’</span></div><div class='input'><span class='fu'>print</span>(<span class='no'>example_model</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in print(example_model, digits = 1): object 'example_model' not found</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

