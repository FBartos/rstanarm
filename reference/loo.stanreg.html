<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Information criteria and cross-validation — loo.stanreg • rstanarm</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Information criteria and cross-validation — loo.stanreg" />
<meta property="og:description" content="For models fit using MCMC, compute approximate leave-one-out
  cross-validation (LOO, LOOIC) or, less preferably, the Widely Applicable
  Information Criterion (WAIC) using the loo
  package. (For \(K\)-fold cross-validation see kfold.stanreg.)
  Functions for  model comparison, and model weighting/averaging are also
  provided.  
Note: these functions are not guaranteed to work
  properly unless the data argument was specified when the model was
  fit. Also, as of loo version 2.0.0 the default number of cores
  is now only 1, but we recommend using as many (or close to as many) cores
  as possible by setting the cores argument or using
  options(mc.cores = VALUE) to set it for an entire session." />
<meta property="og:image" content="https://mc-stan.org/rstanarm/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstanarm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.21.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../dev-notes/index.html">Develop</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
    <li>
      <a href="https://mc-stan.org/posterior">posterior</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/rstanarm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Information criteria and cross-validation</h1>
    <small class="dont-index">Source: <a href='https://github.com/stan-dev/rstanarm/blob/master/R/loo.R'><code>R/loo.R</code></a></small>
    <div class="hidden name"><code>loo.stanreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For models fit using MCMC, compute approximate leave-one-out
  cross-validation (LOO, LOOIC) or, less preferably, the Widely Applicable
  Information Criterion (WAIC) using the <span class="pkg">loo</span>
  package. (For \(K\)-fold cross-validation see <code><a href='kfold.stanreg.html'>kfold.stanreg</a></code>.)
  Functions for  model comparison, and model weighting/averaging are also
  provided.</p>  
<p><strong>Note</strong>: these functions are not guaranteed to work
  properly unless the <code>data</code> argument was specified when the model was
  fit. Also, as of <span class="pkg">loo</span> version <code>2.0.0</code> the default number of cores
  is now only 1, but we recommend using as many (or close to as many) cores
  as possible by setting the <code>cores</code> argument or using
  <code><a href='https://rdrr.io/r/base/options.html'>options(mc.cores = VALUE)</a></code> to set it for an entire session.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for stanreg</span>
<span class='fu'>loo</span>(
  <span class='no'>x</span>,
  <span class='no'>...</span>,
  <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"mc.cores"</span>, <span class='fl'>1</span>),
  <span class='kw'>save_psis</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>k_threshold</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)

<span class='co'># S3 method for stanreg</span>
<span class='fu'>waic</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for stanreg</span>
<span class='fu'>loo_compare</span>(<span class='no'>x</span>, <span class='no'>...</span>, <span class='kw'>criterion</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"loo"</span>, <span class='st'>"kfold"</span>, <span class='st'>"waic"</span>), <span class='kw'>detail</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S3 method for stanreg_list</span>
<span class='fu'>loo_compare</span>(<span class='no'>x</span>, <span class='no'>...</span>, <span class='kw'>criterion</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"loo"</span>, <span class='st'>"kfold"</span>, <span class='st'>"waic"</span>), <span class='kw'>detail</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S3 method for stanreg_list</span>
<span class='fu'>loo_model_weights</span>(<span class='no'>x</span>, <span class='no'>...</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"mc.cores"</span>, <span class='fl'>1</span>), <span class='kw'>k_threshold</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>compare_models</span>(<span class='no'>...</span>, <span class='kw'>loos</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='kw'>detail</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>For <code>loo</code> and <code>waic</code>, a fitted model object returned by
  one of the rstanarm modeling functions. See <a href='stanreg-objects.html'>stanreg-objects</a>.</p>
<p>For the <code>loo_model_weights</code> method, <code>x</code> should be a
  "stanreg_list" object, which is a list of fitted model objects created by
  <code><a href='stanreg_list.html'>stanreg_list</a></code>. <code>loo_compare</code> also allows <code>x</code> to be a
  single stanreg object, with the remaining objects passed via <code>...</code>, or
  a single <code>stanreg_list</code> object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>loo_compare.stanreg</code>, <code>...</code> can contain objects
  returned by the <code>loo</code>, <code><a href='kfold.stanreg.html'>kfold</a></code>, or
  <code>waic</code> method (see the <strong>Examples</strong> section, below).</p>
<p>For <code>loo_model_weights</code>, <code>...</code> should contain arguments (e.g.
  <code>method</code>) to pass to the default <code><a href='https://mc-stan.org/loo/reference/loo_model_weights.html'>loo_model_weights</a></code>
  method from the <span class="pkg">loo</span> package.</p></td>
    </tr>
    <tr>
      <th>cores, save_psis</th>
      <td><p>Passed to <code><a href='https://mc-stan.org/loo/reference/loo.html'>loo</a></code>.</p></td>
    </tr>
    <tr>
      <th>k_threshold</th>
      <td><p>Threshold for flagging estimates of the Pareto shape
parameters \(k\) estimated by <code>loo</code>. See the <em>How to proceed
when <code>loo</code> gives warnings</em> section, below, for details.</p></td>
    </tr>
    <tr>
      <th>criterion</th>
      <td><p>For <code>loo_compare.stanreg</code> and
<code>loo_compare.stanreg_list</code>, should the comparison be based on LOO-CV
(<code>criterion="loo"</code>), K-fold-CV (<code>criterion="kfold"</code>), or WAIC
(<code>criterion="waic"</code>). The default is LOO-CV. See the <strong>Comparing
models</strong> and <strong>Examples</strong> sections below.</p></td>
    </tr>
    <tr>
      <th>detail</th>
      <td><p>For <code>loo_compare.stanreg</code> and
<code>loo_compare.stanreg_list</code>, if <code>TRUE</code> then extra information
about each model (currently just the model formulas) will be printed with
the output.</p></td>
    </tr>
    <tr>
      <th>loos</th>
      <td><p>a list of objects produced by the <code>loo</code> function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The structure of the objects returned by <code>loo</code> and <code>waic</code>
  methods are documented in detail in the <strong>Value</strong> section in
  <code><a href='https://mc-stan.org/loo/reference/loo.html'>loo</a></code> and <code><a href='https://mc-stan.org/loo/reference/waic.html'>waic</a></code> (from the <span class="pkg">loo</span>
  package).</p>
<p><code>loo_compare</code> returns a matrix with class 'compare.loo'. See the
  <strong>Comparing models</strong> section below for more details.</p>
    <h2 class="hasAnchor" id="approximate-loo-cv"><a class="anchor" href="#approximate-loo-cv"></a>Approximate LOO CV</h2>

    <p>The <code>loo</code> method for stanreg objects
  provides an interface to the <span class="pkg">loo</span> package for
  approximate leave-one-out cross-validation (LOO). The LOO Information
  Criterion (LOOIC) has the same purpose as the Akaike Information Criterion
  (AIC) that is used by frequentists. Both are intended to estimate the
  expected log predictive density (ELPD) for a new dataset. However, the AIC
  ignores priors and assumes that the posterior distribution is multivariate
  normal, whereas the functions from the <span class="pkg">loo</span> package do not make this
  distributional assumption and integrate over uncertainty in the parameters.
  This only assumes that any one observation can be omitted without having a
  major effect on the posterior distribution, which can be judged using the
  diagnostic plot provided by the <code><a href='https://mc-stan.org/loo/reference/pareto-k-diagnostic.html'>plot.loo</a></code> method and the
  warnings provided by the <code><a href='https://mc-stan.org/loo/reference/print.loo.html'>print.loo</a></code> method (see the
  <em>How to Use the rstanarm Package</em> vignette for an example of this
  process).</p>
<p></p><h3>How to proceed when <code>loo</code> gives warnings (k_threshold)</h3>
<p>The <code>k_threshold</code> argument to the <code>loo</code> method for <span class="pkg">rstanarm</span>
  models is provided as a possible remedy when the diagnostics reveal
  problems stemming from the posterior's sensitivity to particular
  observations. Warnings about Pareto \(k\) estimates indicate observations
  for which the approximation to LOO is problematic (this is described in
  detail in Vehtari, Gelman, and Gabry (2017) and the
  <span class="pkg">loo</span> package documentation). The
  <code>k_threshold</code> argument can be used to set the \(k\) value above
  which an observation is flagged. If <code>k_threshold</code> is not <code>NULL</code>
  and there are \(J\) observations with \(k\) estimates above
  <code>k_threshold</code> then when <code>loo</code> is called it will refit the
  original model \(J\) times, each time leaving out one of the \(J\)
  problematic observations. The pointwise contributions of these observations
  to the total ELPD are then computed directly and substituted for the
  previous estimates from these \(J\) observations that are stored in the
  object created by <code>loo</code>. Another option to consider is K-fold
  cross-validation, which is documented on a separate page (see
  <code><a href='kfold.stanreg.html'>kfold</a></code>).</p>
<p><strong>Note</strong>: in the warning messages issued by <code>loo</code> about large
  Pareto \(k\) estimates we recommend setting <code>k_threshold</code> to at
  least \(0.7\). There is a theoretical reason, explained in Vehtari,
  Gelman, and Gabry (2017), for setting the threshold to the stricter value
  of \(0.5\), but in practice they find that errors in the LOO
  approximation start to increase non-negligibly when \(k &gt; 0.7\).</p>

    <h2 class="hasAnchor" id="comparing-models"><a class="anchor" href="#comparing-models"></a>Comparing models</h2>

    <p>"loo" (or "waic" or "kfold") objects can be passed
  to the <code><a href='https://mc-stan.org/loo/reference/loo_compare.html'>loo_compare</a></code> function in the <span class="pkg">loo</span> package to
  perform model comparison. <span class="pkg">rstanarm</span> also provides a
  <code>loo_compare.stanreg</code> method that can be used if the "loo" (or "waic"
  or "kfold") object has been added to the fitted model object (see the
  <strong>Examples</strong> section below for how to do this). This second method
  allows <span class="pkg">rstanarm</span> to perform some extra checks that can't be done by
  the <span class="pkg">loo</span> package itself (e.g., verifying that all models to be
  compared were fit using the same outcome variable).</p>
<p><code>loo_compare</code> will return a matrix with one row per model and columns
  containing the ELPD difference and the standard error of the difference. In
  the first row of the matrix will be the model with the largest ELPD
  (smallest LOOIC) and will contain zeros (there is no difference between
  this model and itself). For each of the remaining models the ELPD
  difference and SE are reported relative to the model with the best ELPD
  (the first row). See the <strong>Details</strong> section at the
  <code><a href='https://mc-stan.org/loo/reference/loo_compare.html'>loo_compare</a></code> page in the <span class="pkg">loo</span> package for more
  information.</p>
    <h2 class="hasAnchor" id="model-weights"><a class="anchor" href="#model-weights"></a>Model weights</h2>

    <p>The <code>loo_model_weights</code> method can be used to
  compute model weights for a <code>"stanreg_list"</code> object, which is a list
  of fitted model objects made with <code><a href='stanreg_list.html'>stanreg_list</a></code>. The end of
  the <strong>Examples</strong> section has a demonstration. For details see the
  <code><a href='https://mc-stan.org/loo/reference/loo_model_weights.html'>loo_model_weights</a></code> documentation in the <span class="pkg">loo</span>
  package.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical
  Bayesian model evaluation using leave-one-out cross-validation and WAIC.
  <em>Statistics and Computing</em>. 27(5), 1413--1432.
  doi:10.1007/s11222-016-9696-4. arXiv preprint:
  <a href='http://arxiv.org/abs/1507.04544/'>http://arxiv.org/abs/1507.04544/</a></p>
<p>Yao, Y., Vehtari, A., Simpson, D., and Gelman, A. (2018) Using
  stacking to average Bayesian predictive distributions. <em>Bayesian
  Analysis</em>, advance publication,  doi:10.1214/17-BA1091.
  (<a href='https://projecteuclid.org/euclid.ba/1516093227'>online</a>).</p>
<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and
  Gelman, A. (2019), Visualization in Bayesian workflow. <em>J. R. Stat.
  Soc. A</em>, 182: 389-402. doi:10.1111/rssa.12378,
  (<a href='https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssa.12378'>journal version</a>,
  <a href='https://arxiv.org/abs/1709.01449'>arXiv preprint</a>,
  <a href='https://github.com/jgabry/bayes-vis-paper'>code on GitHub</a>)</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p>The new <a href='http://mc-stan.org/loo/articles/'><span class="pkg">loo</span> package vignettes</a>
  and various <a href='http://mc-stan.org/rstanarm/articles/'><span class="pkg">rstanarm</span> vignettes</a>
  for more examples using <code>loo</code> and related functions with <span class="pkg">rstanarm</span> models.</p></li>
<li><p><code><a href='https://mc-stan.org/loo/reference/pareto-k-diagnostic.html'>pareto-k-diagnostic</a></code> in the <span class="pkg">loo</span> package for
  more on Pareto \(k\) diagnostics.</p></li>
<li><p><code><a href='log_lik.stanreg.html'>log_lik.stanreg</a></code> to directly access the pointwise
  log-likelihood matrix.</p></li>
</ul>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='no'>fit1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stan_glm.html'>stan_glm</a></span>(<span class='no'>mpg</span> ~ <span class='no'>wt</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mtcars</span>, <span class='kw'>refresh</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stan_glm.html'>stan_glm</a></span>(<span class='no'>mpg</span> ~ <span class='no'>wt</span> + <span class='no'>cyl</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mtcars</span>, <span class='kw'>refresh</span> <span class='kw'>=</span> <span class='fl'>0</span>)

<span class='co'># (for bigger models use as many cores as possible)</span>
<span class='no'>loo1</span> <span class='kw'>&lt;-</span> <span class='fu'>loo</span>(<span class='no'>fit1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>loo1</span>)</div><div class='output co'>#&gt; 
#&gt; Computed from 4000 by 32 log-likelihood matrix
#&gt; 
#&gt;          Estimate  SE
#&gt; elpd_loo    -83.6 4.3
#&gt; p_loo         3.3 1.2
#&gt; looic       167.1 8.6
#&gt; ------
#&gt; Monte Carlo SE of elpd_loo is 0.1.
#&gt; 
#&gt; All Pareto k estimates are good (k &lt; 0.5).
#&gt; See help('pareto-k-diagnostic') for details.</div><div class='input'><span class='no'>loo2</span> <span class='kw'>&lt;-</span> <span class='fu'>loo</span>(<span class='no'>fit2</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>loo2</span>)</div><div class='output co'>#&gt; 
#&gt; Computed from 4000 by 32 log-likelihood matrix
#&gt; 
#&gt;          Estimate  SE
#&gt; elpd_loo    -78.6 4.6
#&gt; p_loo         4.1 1.3
#&gt; looic       157.1 9.2
#&gt; ------
#&gt; Monte Carlo SE of elpd_loo is 0.1.
#&gt; 
#&gt; Pareto k diagnostic values:
#&gt;                          Count Pct.    Min. n_eff
#&gt; (-Inf, 0.5]   (good)     31    96.9%   711       
#&gt;  (0.5, 0.7]   (ok)        1     3.1%   456       
#&gt;    (0.7, 1]   (bad)       0     0.0%   &lt;NA&gt;      
#&gt;    (1, Inf)   (very bad)  0     0.0%   &lt;NA&gt;      
#&gt; 
#&gt; All Pareto k estimates are ok (k &lt; 0.7).
#&gt; See help('pareto-k-diagnostic') for details.</div><div class='input'>
<span class='co'># when comparing models the loo objects can be passed to loo_compare</span>
<span class='co'># as individual arguments or as a list of loo objects</span>
<span class='fu'>loo_compare</span>(<span class='no'>loo1</span>, <span class='no'>loo2</span>)</div><div class='output co'>#&gt;      elpd_diff se_diff
#&gt; fit2  0.0       0.0   
#&gt; fit1 -5.0       2.8   </div><div class='input'><span class='fu'>loo_compare</span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>loo1</span>, <span class='no'>loo2</span>))</div><div class='output co'>#&gt;      elpd_diff se_diff
#&gt; fit2  0.0       0.0   
#&gt; fit1 -5.0       2.8   </div><div class='input'>
<span class='co'># if the fitted model objects contain a loo object in the component "loo"</span>
<span class='co'># then the model objects can be passed directly or as a stanreg_list</span>
<span class='no'>fit1</span>$<span class='no'>loo</span> <span class='kw'>&lt;-</span> <span class='no'>loo1</span>
<span class='no'>fit2</span>$<span class='no'>loo</span> <span class='kw'>&lt;-</span> <span class='no'>loo2</span>
<span class='fu'>loo_compare</span>(<span class='no'>fit1</span>, <span class='no'>fit2</span>)</div><div class='output co'>#&gt; Model comparison based on LOO-CV: 
#&gt;      elpd_diff se_diff
#&gt; fit2  0.0       0.0   
#&gt; fit1 -5.0       2.8   </div><div class='input'>
<span class='co'># if the fitted model objects contain a loo object _and_ a waic or kfold</span>
<span class='co'># object, then the criterion argument determines which of them the comparison</span>
<span class='co'># is based on </span>
<span class='no'>fit1</span>$<span class='no'>waic</span> <span class='kw'>&lt;-</span> <span class='fu'>waic</span>(<span class='no'>fit1</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: </span>
#&gt; <span class='warning'>3 (9.4%) p_waic estimates greater than 0.4. We recommend trying loo instead.</span></div><div class='input'><span class='no'>fit2</span>$<span class='no'>waic</span> <span class='kw'>&lt;-</span> <span class='fu'>waic</span>(<span class='no'>fit2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: </span>
#&gt; <span class='warning'>3 (9.4%) p_waic estimates greater than 0.4. We recommend trying loo instead.</span></div><div class='input'><span class='fu'>loo_compare</span>(<span class='no'>fit1</span>, <span class='no'>fit2</span>, <span class='kw'>criterion</span> <span class='kw'>=</span> <span class='st'>"waic"</span>)</div><div class='output co'>#&gt; Model comparison based on WAIC: 
#&gt;      elpd_diff se_diff
#&gt; fit2  0.0       0.0   
#&gt; fit1 -5.0       2.8   </div><div class='input'>
<span class='co'># the models can also be combined into a stanreg_list object, and more </span>
<span class='co'># informative model names can be provided to use when printing</span>
<span class='no'>model_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stanreg_list.html'>stanreg_list</a></span>(<span class='no'>fit1</span>, <span class='no'>fit2</span>, <span class='kw'>model_names</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Fewer predictors"</span>, <span class='st'>"More predictors"</span>))
<span class='fu'>loo_compare</span>(<span class='no'>model_list</span>)</div><div class='output co'>#&gt; Model comparison based on LOO-CV: 
#&gt;                  elpd_diff se_diff
#&gt; More predictors   0.0       0.0   
#&gt; Fewer predictors -5.0       2.8   </div><div class='input'>
<span class='no'>fit3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stan_glm.html'>stan_glm</a></span>(<span class='no'>mpg</span> ~ <span class='no'>disp</span> * <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span>(<span class='no'>cyl</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mtcars</span>, <span class='kw'>refresh</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='no'>loo3</span> <span class='kw'>&lt;-</span> <span class='fu'>loo</span>(<span class='no'>fit3</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>k_threshold</span> <span class='kw'>=</span> <span class='fl'>0.7</span>)</div><div class='output co'>#&gt; <span class='message'>All pareto_k estimates below user-specified threshold of 0.7. </span>
#&gt; <span class='message'>Returning loo object.</span></div><div class='input'><span class='fu'>loo_compare</span>(<span class='no'>loo1</span>, <span class='no'>loo2</span>, <span class='no'>loo3</span>)</div><div class='output co'>#&gt;      elpd_diff se_diff
#&gt; fit3  0.0       0.0   
#&gt; fit2 -1.0       4.2   
#&gt; fit1 -6.0       5.1   </div><div class='input'>
<span class='co'># setting detail=TRUE will also print model formulas if used with</span>
<span class='co'># loo_compare.stanreg or loo_compare.stanreg_list</span>
<span class='no'>fit3</span>$<span class='no'>loo</span> <span class='kw'>&lt;-</span> <span class='no'>loo3</span>
<span class='no'>model_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stanreg_list.html'>stanreg_list</a></span>(<span class='no'>fit1</span>, <span class='no'>fit2</span>, <span class='no'>fit3</span>)
<span class='fu'>loo_compare</span>(<span class='no'>model_list</span>, <span class='kw'>detail</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Model formulas: 
#&gt;  fit1:  mpg ~ wt
#&gt;  fit2:  mpg ~ wt + cyl
#&gt;  fit3:  mpg ~ disp * as.factor(cyl)
#&gt; 
#&gt; Model comparison based on LOO-CV: 
#&gt;      elpd_diff se_diff
#&gt; fit3  0.0       0.0   
#&gt; fit2 -1.0       4.2   
#&gt; fit1 -6.0       5.1   </div><div class='input'>
<span class='co'># Computing model weights</span>
<span class='co'>#</span>
<span class='co'># if the objects in model_list already have 'loo' components then those</span>
<span class='co'># will be used. otherwise loo will be computed for each model internally</span>
<span class='co'># (in which case the 'cores' argument may also be used and is passed to loo())</span>
<span class='fu'>loo_model_weights</span>(<span class='no'>model_list</span>)  <span class='co'># defaults to method="stacking"</span></div><div class='output co'>#&gt; Method: stacking
#&gt; ------
#&gt;      weight
#&gt; fit1 0.000 
#&gt; fit2 0.494 
#&gt; fit3 0.506 </div><div class='input'><span class='fu'>loo_model_weights</span>(<span class='no'>model_list</span>,  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pseudobma"</span>)</div><div class='output co'>#&gt; Method: pseudo-BMA+ with Bayesian bootstrap
#&gt; ------
#&gt;      weight
#&gt; fit1 0.034 
#&gt; fit2 0.396 
#&gt; fit3 0.570 </div><div class='input'><span class='fu'>loo_model_weights</span>(<span class='no'>model_list</span>,  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pseudobma"</span>, <span class='kw'>BB</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; Method: pseudo-BMA
#&gt; ------
#&gt;      weight
#&gt; fit1 0.002 
#&gt; fit2 0.273 
#&gt; fit3 0.725 </div><div class='input'>
<span class='co'># you can also pass precomputed loo objects directly to loo_model_weights</span>
<span class='no'>loo_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>A</span> <span class='kw'>=</span> <span class='no'>loo1</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='no'>loo2</span>, <span class='kw'>C</span> <span class='kw'>=</span> <span class='no'>loo3</span>) <span class='co'># names optional (affects printing)</span>
<span class='fu'>loo_model_weights</span>(<span class='no'>loo_list</span>)</div><div class='output co'>#&gt; Method: stacking
#&gt; ------
#&gt;   weight
#&gt; A 0.000 
#&gt; B 0.494 
#&gt; C 0.506 </div><div class='input'># }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


