<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian joint longitudinal and time-to-event models via Stan — stan_jm • rstanarm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bayesian joint longitudinal and time-to-event models via Stan — stan_jm" />

<meta property="og:description" content="
Fits a shared parameter joint model for longitudinal and time-to-event 
(e.g. survival) data under a Bayesian framework using Stan." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstanarm</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.17.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../dev-notes/index.html">Develop</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/rstanarm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian joint longitudinal and time-to-event models via Stan</h1>
    
    <div class="hidden name"><code>stan_jm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><img src='figures/stanlogo.png' width="25px" alt="http://mc-stan.org/about/logo/" />
Fits a shared parameter joint model for longitudinal and time-to-event 
(e.g. survival) data under a Bayesian framework using Stan.</p>
    
    </div>

    <pre class="usage"><span class='fu'>stan_jm</span>(<span class='no'>formulaLong</span>, <span class='no'>dataLong</span>, <span class='no'>formulaEvent</span>, <span class='no'>dataEvent</span>, <span class='no'>time_var</span>, <span class='no'>id_var</span>,
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>gaussian</span>, <span class='kw'>assoc</span> <span class='kw'>=</span> <span class='st'>"etavalue"</span>, <span class='kw'>lag_assoc</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>grp_assoc</span>,
  <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='fl'>1e-05</span>, <span class='kw'>basehaz</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"bs"</span>, <span class='st'>"weibull"</span>, <span class='st'>"piecewise"</span>), <span class='no'>basehaz_ops</span>,
  <span class='kw'>qnodes</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>init</span> <span class='kw'>=</span> <span class='st'>"prefit"</span>, <span class='no'>weights</span>, <span class='kw'>priorLong</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>priorLong_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>priorLong_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>cauchy</a></span>(<span class='fl'>0</span>, <span class='fl'>5</span>),
  <span class='kw'>priorEvent</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>priorEvent_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>priorEvent_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>cauchy</a></span>(), <span class='kw'>priorEvent_assoc</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_covariance</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>lkj</a></span>(), <span class='kw'>prior_PD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sampling"</span>,
  <span class='st'>"meanfield"</span>, <span class='st'>"fullrank"</span>), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>max_treedepth</span> <span class='kw'>=</span> <span class='fl'>10L</span>,
  <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formulaLong</th>
      <td><p>A two-sided linear formula object describing both the 
fixed-effects and random-effects parts of the longitudinal submodel,
similar in vein to formula specification in the <strong>lme4</strong> package
(see <code><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></code> or the <strong>lme4</strong> vignette for details). 
Note however that the double bar (<code>||</code>) notation is not allowed 
when specifying the random-effects parts of the formula, and neither
are nested grouping factors (e.g. <code>(1 | g1/g2))</code> or 
<code>(1 | g1:g2)</code>, where <code>g1</code>, <code>g2</code> are grouping factors. 
For a multivariate joint model (i.e. more than one longitudinal marker) 
this should be a list of such formula objects, with each element
of the list providing the formula for one of the longitudinal submodels.</p></td>
    </tr>
    <tr>
      <th>dataLong</th>
      <td><p>A data frame containing the variables specified in
<code>formulaLong</code>. If fitting a multivariate joint model, then this can
be either a single data frame which contains the data for all 
longitudinal submodels, or it can be a list of data frames where each
element of the list provides the data for one of the longitudinal 
submodels.</p></td>
    </tr>
    <tr>
      <th>formulaEvent</th>
      <td><p>A two-sided formula object describing the event
submodel. The left hand side of the formula should be a <code><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv()</a></code> 
object. See <code><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></code>.</p></td>
    </tr>
    <tr>
      <th>dataEvent</th>
      <td><p>A data frame containing the variables specified in
<code>formulaEvent</code>.</p></td>
    </tr>
    <tr>
      <th>time_var</th>
      <td><p>A character string specifying the name of the variable 
in <code>dataLong</code> which represents time.</p></td>
    </tr>
    <tr>
      <th>id_var</th>
      <td><p>A character string specifying the name of the variable in
<code>dataLong</code> which distinguishes between individuals. This can be
left unspecified if there is only one grouping factor (which is assumed
to be the individual). If there is more than one grouping factor (i.e.
clustering beyond the level of the individual) then the <code>id_var</code>
argument must be specified.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>The family (and possibly also the link function) for the 
longitudinal submodel(s). See <code><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></code> for details. 
If fitting a multivariate joint model, then this can optionally be a
list of families, in which case each element of the list specifies the
family for one of the longitudinal submodels.</p></td>
    </tr>
    <tr>
      <th>assoc</th>
      <td><p>A character string or character vector specifying the joint
model association structure. Possible association structures that can
be used include: "etavalue" (the default); "etaslope"; "etaauc"; 
"muvalue"; "muslope"; "muauc"; "shared_b"; "shared_coef"; or "null". 
These are described in the <strong>Details</strong> section below. For a multivariate 
joint model, different association structures can optionally be used for 
each longitudinal submodel by specifying a list of character
vectors, with each element of the list specifying the desired association 
structure for one of the longitudinal submodels. Specifying <code>assoc = NULL</code>
will fit a joint model with no association structure (equivalent  
to fitting separate longitudinal and time-to-event models). It is also 
possible to include interaction terms between the association term 
("etavalue", "etaslope", "muvalue", "muslope") and observed data/covariates. 
It is also possible, when fitting a multivariate joint model, to include 
interaction terms between the association terms ("etavalue" or "muvalue") 
corresponding to the different longitudinal outcomes. See the 
<strong>Details</strong> section as well as the <strong>Examples</strong> below.</p></td>
    </tr>
    <tr>
      <th>lag_assoc</th>
      <td><p>A non-negative scalar specifying the time lag that should be
used for the association structure. That is, the hazard of the event at 
time <em>t</em> will be assumed to be associated with the value/slope/auc of 
the longitudinal marker at time <em>t-u</em>, where <em>u</em> is the time lag.
If fitting a multivariate joint model, then a different time lag can be used
for each longitudinal marker by providing a numeric vector of lags, otherwise
if a scalar is provided then the specified time lag will be used for all 
longitudinal markers. Note however that only one time lag  can be specified 
for linking each longitudinal marker to the 
event, and that that time lag will be used for all association structure
types (e.g. <code>"etavalue"</code>, <code>"etaslope"</code>, <code>"etaauc"</code>, 
<code>"muvalue"</code>, etc) that are specified for that longitudinal marker in
the <code>assoc</code> argument.</p></td>
    </tr>
    <tr>
      <th>grp_assoc</th>
      <td><p>Character string specifying the method for combining information
across lower level units clustered within an individual when forming the
association structure. This is only relevant when a grouping factor is  
specified in <code>formulaLong</code> that corresponds to clustering within 
individuals. This can be specified as either <code>"sum"</code>, <code>mean</code>,
<code>"min"</code> or <code>"max"</code>. For example, specifying <code>grp_assoc = "sum"</code>
indicates that the association structure should be based on a summation across 
the lower level units clustered within an individual, or specifying
<code>grp_assoc = "mean"</code>  indicates that the association structure 
should be based on the mean (i.e. average) taken across the lower level 
units clustered within an individual.
So, for example, specifying <code>assoc = "muvalue"</code> 
and <code>grp_assoc = "sum"</code> would mean that the log hazard at time 
<em>t</em> for individual <em>i</em> would be linearly related to the sum of
the expected values at time <em>t</em> for each of the lower level 
units (which may be for example tumor lesions) clustered within that 
individual.</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>The half-width of the central difference used to numerically
calculate the derivate when the <code>"etaslope"</code> association structure 
is used.</p></td>
    </tr>
    <tr>
      <th>basehaz</th>
      <td><p>A character string indicating which baseline hazard to use
for the event submodel. Options are a B-splines approximation estimated 
for the log baseline hazard (<code>"bs"</code>, the default), a Weibull 
baseline hazard (<code>"weibull"</code>, the default), or a piecewise
constant baseline hazard (<code>"piecewise"</code>). (Note however that there  
is currently limited post-estimation functionality available for
models estimated using a piecewise constant baseline hazard).</p></td>
    </tr>
    <tr>
      <th>basehaz_ops</th>
      <td><p>A named list specifying options related to the baseline
hazard. Currently this can include: <br /></p><dl class='dl-horizontal'>
  <dt><code>df</code></dt><dd><p>A positive integer specifying the degrees of freedom 
  for the B-splines if <code>basehaz = "bs"</code>, or the number of
  intervals used for the piecewise constant baseline hazard if 
  <code>basehaz = "piecewise"</code>. The default is 6.</p></dd>
  <dt><code>knots</code></dt><dd><p>An optional numeric vector specifying the internal knot 
  locations for the B-splines if <code>basehaz = "bs"</code>, or the 
  internal cut-points for defining intervals of the piecewise constant 
  baseline hazard if <code>basehaz = "piecewise"</code>. Knots cannot be
  specified if <code>df</code> is specified. If not specified, then the 
  default is to use <code>df - 4</code> knots if <code>basehaz = "bs"</code>,
  or <code>df - 1</code> knots if <code>basehaz = "piecewise"</code>, which are
  placed at equally spaced percentiles of the distribution of
  observed event times.</p></dd>
</dl></td>
    </tr>
    <tr>
      <th>qnodes</th>
      <td><p>The number of nodes to use for the Gauss-Kronrod quadrature
that is used to evaluate the cumulative hazard in the likelihood function. 
Options are 15 (the default), 11 or 7.</p></td>
    </tr>
    <tr>
      <th>init</th>
      <td><p>The method for generating the initial values for the MCMC.
The default is <code>"prefit"</code>, which uses those obtained from 
fitting separate longitudinal and time-to-event models prior to 
fitting the joint model. The separate longitudinal model is a 
(possibly multivariate) generalised linear mixed 
model estimated using variational bayes. This is achieved via the 
<code><a href='stan_mvmer.html'>stan_mvmer</a></code> function with <code>algorithm = "meanfield"</code>.
The separate Cox model is estimated using <code><a href='http://www.rdocumentation.org/packages/survival/topics/coxph'>coxph</a></code>. 
This is achieved
using the and time-to-event models prior  
to fitting the joint model. The separate models are estimated using the
<code><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></code> and <code><a href='http://www.rdocumentation.org/packages/survival/topics/coxph'>coxph</a></code> functions.
This should provide reasonable initial values which should aid the 
MCMC sampler. Parameters that cannot be obtained from 
fitting separate longitudinal and time-to-event models are initialised 
using the "random" method for <code><a href='http://www.rdocumentation.org/packages/rstan/topics/stan'>stan</a></code>.
However it is recommended that any final analysis should ideally
be performed with several MCMC chains each initiated from a different
set of initial values; this can be obtained by setting
<code>init = "random"</code>. In addition, other possibilities for specifying 
<code>init</code> are the same as those described for <code><a href='http://www.rdocumentation.org/packages/rstan/topics/stan'>stan</a></code>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Experimental and should be used with caution. The 
user can optionally supply a 2-column data frame containing a set of
'prior weights' to be used in the estimation process. The data frame should
contain two columns: the first containing the IDs for each individual, and 
the second containing the corresponding weights. The data frame should only
have one row for each individual; that is, weights should be constant 
within individuals.</p></td>
    </tr>
    <tr>
      <th>priorLong, priorEvent, priorEvent_assoc</th>
      <td><p>The prior distributions for the 
regression coefficients in the longitudinal submodel(s), event submodel,
and the association parameter(s). Can be a call to one of the various functions 
provided by <span class="pkg">rstanarm</span> for specifying priors. The subset of these functions 
that can be used for the prior on the coefficients can be grouped into several 
"families":</p>
<table class='table'>
<tr><td><strong>Family</strong></td><td><strong>Functions</strong></td></tr>
<tr><td><em>Student t family</em></td><td><code>normal</code>, <code>student_t</code>, <code>cauchy</code></td></tr>
<tr><td><em>Hierarchical shrinkage family</em></td><td><code>hs</code>, <code>hs_plus</code></td></tr>
<tr><td><em>Laplace family</em></td><td><code>laplace</code>, <code>lasso</code></td></tr>
</table>


<p>See the <a href='priors.html'>priors help page</a> for details on the families and 
how to specify the arguments for all of the functions in the table above.
To omit a prior ---i.e., to use a flat (improper) uniform prior---
<code>prior</code> can be set to <code>NULL</code>, although this is rarely a good
idea.</p>
<p><strong>Note:</strong> Unless <code>QR=TRUE</code>, if <code>prior</code> is from the Student t
family or Laplace family, and if the <code>autoscale</code> argument to the 
function used to specify the prior (e.g. <code><a href='priors.html'>normal</a></code>) is left at 
its default and recommended value of <code>TRUE</code>, then the default or 
user-specified prior scale(s) may be adjusted internally based on the scales
of the predictors. See the <a href='priors.html'>priors help page</a> for details on
the rescaling and the <code><a href='prior_summary.stanreg.html'>prior_summary</a></code> function for a summary of
the priors used for a particular model.</p></td>
    </tr>
    <tr>
      <th>priorLong_intercept, priorEvent_intercept</th>
      <td><p>The prior distributions
for the intercepts in the longitudinal submodel(s) and event submodel. 
Can be a call to <code>normal</code>, <code>student_t</code> or 
<code>cauchy</code>. See the <a href='priors.html'>priors help page</a> for details on 
these functions. To omit a prior on the intercept ---i.e., to use a flat
(improper) uniform prior--- <code>prior_intercept</code> can be set to
<code>NULL</code>.</p>
<p><strong>Note:</strong> The prior distribution for the intercept is set so it
applies to the value when all predictors are centered. Moreover, 
note that a prior is only placed on the intercept for the event submodel
when a Weibull baseline hazard has been specified. For the B-splines and
piecewise constant baseline hazards there is not intercept parameter that
is given a prior distribution; an intercept parameter will be shown in 
the output for the fitted model, but this just corresponds to the 
necessary post-estimation adjustment in the linear predictor due to the
centering of the predictiors in the event submodel.</p></td>
    </tr>
    <tr>
      <th>priorLong_aux</th>
      <td><p>The prior distribution for the "auxiliary" parameters
in the longitudinal submodels (if applicable). 
The "auxiliary" parameter refers to a different parameter 
depending on the <code>family</code>. For Gaussian models <code>priorLong_aux</code> 
controls <code>"sigma"</code>, the error 
standard deviation. For negative binomial models <code>priorLong_aux</code> controls 
<code>"reciprocal_dispersion"</code>, which is similar to the 
<code>"size"</code> parameter of <code><a href='http://www.rdocumentation.org/packages/stats/topics/NegBinomial'>rnbinom</a></code>:
smaller values of <code>"reciprocal_dispersion"</code> correspond to 
greater dispersion. For gamma models <code>priorLong_aux</code> sets the prior on 
to the <code>"shape"</code> parameter (see e.g., 
<code><a href='http://www.rdocumentation.org/packages/stats/topics/GammaDist'>rgamma</a></code>), and for inverse-Gaussian models it is the 
so-called <code>"lambda"</code> parameter (which is essentially the reciprocal of
a scale parameter). Binomial and Poisson models do not have auxiliary 
parameters.</p>
<p><code>priorLong_aux</code> can be a call to <code>exponential</code> to 
use an exponential distribution, or <code>normal</code>, <code>student_t</code> or 
<code>cauchy</code>, which results in a half-normal, half-t, or half-Cauchy 
prior. See <code><a href='priors.html'>priors</a></code> for details on these functions. To omit a 
prior ---i.e., to use a flat (improper) uniform prior--- set 
<code>priorLong_aux</code> to <code>NULL</code>.</p>
<p>If fitting a multivariate joint model, you have the option to
specify a list of prior distributions, however the elements of the list
that correspond to any longitudinal submodel which does not have an 
auxiliary parameter will be ignored.</p></td>
    </tr>
    <tr>
      <th>priorEvent_aux</th>
      <td><p>The prior distribution for the "auxiliary" parameters
in the event submodel. The "auxiliary" parameters refers to different  
parameters depending on the baseline hazard. For <code>basehaz = "weibull"</code>
the auxiliary parameter is the Weibull shape parameter. For 
<code>basehaz = "bs"</code> the auxiliary parameters are the coefficients for the
B-spline approximation to the log baseline hazard.
For <code>basehaz = "piecewise"</code> the auxiliary parameters are the piecewise
estimates of the log baseline hazard.</p></td>
    </tr>
    <tr>
      <th>prior_covariance</th>
      <td><p>Cannot be <code>NULL</code>; see <code><a href='priors.html'>priors</a></code> for
more information about the prior distributions on covariance matrices.
Note however that the default prior for covariance matrices in 
<code>stan_jm</code> is slightly different to that in <code><a href='stan_glmer.html'>stan_glmer</a></code> 
(the details of which are described on the <code><a href='priors.html'>priors</a></code> page).</p></td>
    </tr>
    <tr>
      <th>prior_PD</th>
      <td><p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to draw from the prior predictive distribution instead of
conditioning on the outcome.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>A string (possibly abbreviated) indicating the 
estimation approach to use. Can be <code>"sampling"</code> for MCMC (the
default), <code>"optimizing"</code> for optimization, <code>"meanfield"</code> for
variational inference with independent normal distributions, or
<code>"fullrank"</code> for variational inference with a multivariate normal
distribution. See <code><a href='rstanarm-package.html'>rstanarm-package</a></code> for more details on the
estimation algorithms. NOTE: not all fitting functions support all four
algorithms.</p></td>
    </tr>
    <tr>
      <th>adapt_delta</th>
      <td><p>Only relevant if <code>algorithm="sampling"</code>. See 
the <a href='adapt_delta.html'>adapt_delta</a> help page for details.</p></td>
    </tr>
    <tr>
      <th>max_treedepth</th>
      <td><p>A positive integer specifying the maximum treedepth 
for the non-U-turn sampler. See the <code>control</code> argument in 
<code><a href='http://www.rdocumentation.org/packages/rstan/topics/stan'>stan</a></code>.</p></td>
    </tr>
    <tr>
      <th>QR</th>
      <td><p>A logical scalar defaulting to <code>FALSE</code>, but if <code>TRUE</code>
applies a scaled <code>qr</code> decomposition to the design matrix. The
transformation does not change the likelihood of the data but is
recommended for computational reasons when there are multiple predictors.
See the <a href='QR-argument.html'>QR-argument</a> documentation page for details on how
<span class="pkg">rstanarm</span> does the transformation and important information about how
to interpret the prior distributions of the model parameters when using
<code>QR=TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>sparse</th>
      <td><p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to use a sparse representation of the design (X) matrix. 
If <code>TRUE</code>, the the design matrix is not centered (since that would 
destroy the sparsity) and likewise it is not possible to specify both 
<code>QR = TRUE</code> and <code>sparse = TRUE</code>. Depending on how many zeros
there are in the design matrix, setting <code>sparse = TRUE</code> may make
the code run faster and can consume much less RAM.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to the function in the <span class="pkg">rstan</span> 
package (<code><a href='http://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-sampling'>sampling</a></code>, <code><a href='http://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-vb'>vb</a></code>, or 
<code><a href='http://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-optimizing'>optimizing</a></code>), corresponding to the estimation method 
named by <code>algorithm</code>. For example, if <code>algorithm</code> is
<code>"sampling"</code> it is possibly to specify <code>iter</code>, <code>chains</code>,
<code>cores</code>, <code>refresh</code>, etc.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='stanreg-objects.html'>stanjm</a> object is returned.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>stan_jm</code> function can be used to fit a joint model (also 
  known as a shared parameter model) for longitudinal and time-to-event data 
  under a Bayesian framework. The underlying
  estimation is carried out using the Bayesian C++ package Stan 
  (<a href='http://mc-stan.org/'>http://mc-stan.org/</a>). <br />
  <br /> 
  The joint model may be univariate (with only one longitudinal submodel) or
  multivariate (with more than one longitudinal submodel). 
  For the longitudinal submodel a (possibly multivariate) generalised linear 
  mixed model is assumed with any of the <code><a href='http://www.rdocumentation.org/packages/stats/topics/family'>family</a></code> choices 
  allowed by <code><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></code>. If a multivariate joint model is specified 
  (by providing a list of formulas in the <code>formulaLong</code> argument), then
  the multivariate longitudinal submodel consists of a multivariate generalized  
  linear model (GLM) with group-specific terms that are assumed to be correlated
  across the different GLM submodels. That is, within
  a grouping factor (for example, patient ID) the group-specific terms are
  assumed to be correlated across the different GLM submodels. It is 
  possible to specify a different outcome type (for example a different
  family and/or link function) for each of the GLM submodels, by providing
  a list of <code><a href='http://www.rdocumentation.org/packages/stats/topics/family'>family</a></code> objects in the <code>family</code> 
  argument. Multi-level 
  clustered data are allowed, and that additional clustering can occur at a 
  level higher than the individual-level (e.g. patients clustered within 
  clinics), or at a level lower than the individual-level (e.g. tumor lesions
  clustered within patients). If the clustering occurs at a level lower than
  the individual, then the user needs to indicate how the lower level 
  clusters should be handled when forming the association structure between
  the longitudinal and event submodels (see the <code>grp_assoc</code> argument
  described above). <br />
  <br />
  For the event submodel a parametric
  proportional hazards model is assumed. The baseline hazard can be estimated 
  using either a cubic B-splines approximation (<code>basehaz = "bs"</code>, the
  default), a Weibull distribution (<code>basehaz = "weibull"</code>), or a
  piecewise constant baseline hazard (<code>basehaz = "piecewise"</code>).
  If the B-spline or piecewise constant baseline hazards are used, 
  then the degrees of freedom or the internal knot locations can be 
  (optionally) specified. If
  the degrees of freedom are specified (through the <code>df</code> argument) then
  the knot locations are automatically generated based on the 
  distribution of the observed event times (not including censoring times). 
  Otherwise internal knot locations can be specified 
  directly through the <code>knots</code> argument. If neither <code>df</code> or
  <code>knots</code> is specified, then the default is to set <code>df</code> equal to 6.
  It is not possible to specify both <code>df</code> and <code>knots</code>. <br />
  <br />
  Time-varying covariates are allowed in both the 
  longitudinal and event submodels. These should be specified in the data 
  in the same way as they normally would when fitting a separate 
  longitudinal model using <code><a href='http://www.rdocumentation.org/packages/lme4/topics/lmer'>lmer</a></code> or a separate 
  time-to-event model using <code><a href='http://www.rdocumentation.org/packages/survival/topics/coxph'>coxph</a></code>. These time-varying
  covariates should be exogenous in nature, otherwise they would perhaps 
  be better specified as an additional outcome (i.e. by including them as an 
  additional longitudinal outcome in the joint model). <br />
  <br />
  Bayesian estimation of the joint model is performed via MCMC. The Bayesian  
  model includes independent priors on the 
  regression coefficients for both the longitudinal and event submodels, 
  including the association parameter(s) (in much the same way as the
  regression parameters in <code><a href='stan_glm.html'>stan_glm</a></code>) and
  priors on the terms of a decomposition of the covariance matrices of the
  group-specific parameters. 
  See <code><a href='priors.html'>priors</a></code> for more information about the priors distributions
  that are available. <br />
  <br />
  Gauss-Kronrod quadrature is used to numerically evaluate the integral  
  over the cumulative hazard in the likelihood function for the event submodel.
  The accuracy of the numerical approximation can be controlled using the
  number of quadrature nodes, specified through the <code>qnodes</code> 
  argument. Using a higher number of quadrature nodes will result in a more 
  accurate approximation.</p>  
<p></p><h3>Association structures</h3>
    The association structure for the joint model can be based on any of the 
  following parameterisations: 
    <ul>
<li><p>current value of the linear predictor in the 
        longitudinal submodel (<code>"etavalue"</code>)</p></li>
<li><p>first derivative (slope) of the linear predictor in the 
        longitudinal submodel (<code>"etaslope"</code>)</p></li>
<li><p>the area under the curve of the linear predictor in the 
        longitudinal submodel (<code>"etaauc"</code>)</p></li>
<li><p>current expected value of the longitudinal submodel 
        (<code>"muvalue"</code>)</p></li>
<li><p>the area under the curve of the expected value from the 
        longitudinal submodel (<code>"muauc"</code>)</p></li>
<li><p>shared individual-level random effects (<code>"shared_b"</code>)</p></li>
<li><p>shared individual-level random effects which also incorporate 
        the corresponding fixed effect as well as any corresponding 
        random effects for clustering levels higher than the individual)
        (<code>"shared_coef"</code>)</p></li>
<li><p>interactions between association terms and observed data/covariates
        (<code>"etavalue_data"</code>, <code>"etaslope_data"</code>, <code>"muvalue_data"</code>, 
        <code>"muslope_data"</code>). These are described further below.</p></li>
<li><p>interactions between association terms corresponding to different 
        longitudinal outcomes in a multivariate joint model 
        (<code>"etavalue_etavalue(#)"</code>, <code>"etavalue_muvalue(#)"</code>,
        <code>"muvalue_etavalue(#)"</code>, <code>"muvalue_muvalue(#)"</code>). These
        are described further below.</p></li>
<li><p>no association structure (equivalent to fitting separate 
        longitudinal and event models) (<code>"null"</code> or <code>NULL</code>)</p></li>
</ul>
  More than one association structure can be specified, however,
  not all possible combinations are allowed.   
  Note that for the lagged association structures baseline values (time = 0) 
  are used for the instances 
  where the time lag results in a time prior to baseline. When using the 
  <code>"etaauc"</code> or <code>"muauc"</code> association structures, the area under
  the curve is evaluated using Gauss-Kronrod quadrature with 15 quadrature 
  nodes. By default, <code>"shared_b"</code> and <code>"shared_coef"</code> contribute 
  all random effects to the association structure; however, a subset of the 
  random effects can be chosen by specifying their indices between parentheses 
  as a suffix, for example, <code>"shared_b(1)"</code> or <code>"shared_b(1:3)"</code> or 
  <code>"shared_b(1,2,4)"</code>, and so on. <br />
  <br /> 
  In addition, several association terms (<code>"etavalue"</code>, <code>"etaslope"</code>,
  <code>"muvalue"</code>, <code>"muslope"</code>) can be interacted with observed 
  data/covariates. To do this, use the association term's main handle plus a
  suffix of <code>"_data"</code> then followed by the model matrix formula in 
  parentheses. For example if we had a variable in our dataset for gender 
  named <code>sex</code> then we might want to obtain different estimates for the 
  association between the current slope of the marker and the risk of the 
  event for each gender. To do this we would specify 
  <code>assoc = c("etaslope", "etaslope_data(~ sex)")</code>. <br />
  <br />
  It is also possible, when fitting  a multivariate joint model, to include 
  interaction terms between the association terms themselves (this only
  applies for interacting <code>"etavalue"</code> or <code>"muvalue"</code>). For example, 
  if we had a joint model with two longitudinal markers, we could specify 
  <code>assoc = list(c("etavalue", "etavalue_etavalue(2)"), "etavalue")</code>.
  The first element of list says we want to use the value of the linear
  predictor for the first marker, as well as it's interaction with the
  value of the linear predictor for the second marker. The second element of 
  the list says we want to also include the expected value of the second marker 
  (i.e. as a "main effect"). Therefore, the linear predictor for the event 
  submodel would include the "main effects" for each marker as well as their
  interaction. <br />
  <br />
  There are additional examples in the <strong>Examples</strong> section below.
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='stanreg-objects.html'>stanreg-objects</a></code>, <code><a href='stanmvreg-methods.html'>stanmvreg-methods</a></code>, 
  <code><a href='print.stanreg.html'>print.stanmvreg</a></code>, <code><a href='summary.stanreg.html'>summary.stanmvreg</a></code>,
  <code><a href='posterior_traj.html'>posterior_traj</a></code>, <code><a href='posterior_survfit.html'>posterior_survfit</a></code>, 
  <code><a href='posterior_predict.stanreg.html'>posterior_predict</a></code>, <code><a href='posterior_interval.stanreg.html'>posterior_interval</a></code>,
  <code><a href='pp_check.stanreg.html'>pp_check</a></code>, <code><a href='ps_check.html'>ps_check</a></code>, <code><a href='stan_mvmer.html'>stan_mvmer</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#####</span>
<span class='co'># Univariate joint model, with association structure based on the </span>
<span class='co'># current value of the linear predictor</span>
<span class='no'>f1</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_jm</span>(<span class='kw'>formulaLong</span> <span class='kw'>=</span> <span class='no'>logBili</span> ~ <span class='no'>year</span> + (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>id</span>),
              <span class='kw'>dataLong</span> <span class='kw'>=</span> <span class='no'>pbcLong</span>,
              <span class='kw'>formulaEvent</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>futimeYears</span>, <span class='no'>death</span>) ~ <span class='no'>sex</span> + <span class='no'>trt</span>,
              <span class='kw'>dataEvent</span> <span class='kw'>=</span> <span class='no'>pbcSurv</span>,
              <span class='kw'>time_var</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
              <span class='co'># this next line is only to keep the example small in size!</span>
              <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; Fitting a univariate joint model.
#&gt; 
#&gt; Please note the warmup may be much slower than later iterations!
#&gt; 
#&gt; SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).
#&gt; 
#&gt; Gradient evaluation took 0.000316 seconds
#&gt; 1000 transitions using 10 leapfrog steps per transition would take 3.16 seconds.
#&gt; Adjust your expectations accordingly!
#&gt; 
#&gt; 
#&gt; Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt; 
#&gt;  Elapsed Time: 3.74283 seconds (Warm-up)
#&gt;                2.56112 seconds (Sampling)
#&gt;                6.30394 seconds (Total)
#&gt; </div><div class='input'><span class='fu'>print</span>(<span class='no'>f1</span>)</div><div class='output co'>#&gt; stan_jm
#&gt;  formula (Long1): logBili ~ year + (1 | id)
#&gt;  family  (Long1): gaussian [identity]
#&gt;  formula (Event): Surv(futimeYears, death) ~ sex + trt
#&gt;  baseline hazard: bs
#&gt;  assoc:           etavalue (Long1)
#&gt; ------
#&gt; 
#&gt; Longitudinal submodel: logBili
#&gt;             Median MAD_SD
#&gt; (Intercept) 0.766  0.159 
#&gt; year        0.092  0.009 
#&gt; sigma       0.509  0.020 
#&gt; 
#&gt; Event submodel:
#&gt;                 Median MAD_SD exp(Median)
#&gt; (Intercept)     -3.059  0.586  0.047     
#&gt; sexf            -0.327  0.575  0.721     
#&gt; trt             -0.684  0.457  0.505     
#&gt; Long1|etavalue   1.448  0.285  4.256     
#&gt; b-splines-coef1 -1.349  1.068     NA     
#&gt; b-splines-coef2  0.136  0.977     NA     
#&gt; b-splines-coef3 -1.644  1.245     NA     
#&gt; b-splines-coef4  0.545  1.604     NA     
#&gt; b-splines-coef5 -0.188  1.608     NA     
#&gt; b-splines-coef6 -0.520  1.529     NA     
#&gt; 
#&gt; Group-level error terms:
#&gt;  Groups Name              Std.Dev.
#&gt;  id     Long1|(Intercept) 1.311   
#&gt; Num. levels: id 40 
#&gt; 
#&gt; Sample avg. posterior predictive distribution 
#&gt; of longitudinal outcomes:
#&gt;                Median MAD_SD
#&gt; Long1|mean_PPD 0.586  0.040 
#&gt; 
#&gt; ------
#&gt; For info on the priors used see help('prior_summary.stanreg').</div><div class='input'><span class='fu'>summary</span>(<span class='no'>f1</span>)</div><div class='output co'>#&gt; 
#&gt; Model Info:
#&gt; 
#&gt;  function:        stan_jm
#&gt;  formula (Long1): logBili ~ year + (1 | id)
#&gt;  family  (Long1): gaussian [identity]
#&gt;  formula (Event): Surv(futimeYears, death) ~ sex + trt
#&gt;  baseline hazard: bs
#&gt;  assoc:           etavalue (Long1)
#&gt;  algorithm:       sampling
#&gt;  priors:          see help('prior_summary')
#&gt;  sample:          500 (posterior sample size)
#&gt;  num obs:         304 (Long1)
#&gt;  num subjects:    40
#&gt;  num events:      29 (72.5%)
#&gt;  groups:          id (40)
#&gt;  runtime:         0.1 mins
#&gt; 
#&gt; Estimates:
#&gt;                                                 mean     sd       2.5%  
#&gt; Long1|(Intercept)                                0.767    0.172    0.440
#&gt; Long1|year                                       0.092    0.009    0.075
#&gt; Long1|sigma                                      0.509    0.021    0.469
#&gt; Long1|mean_PPD                                   0.587    0.041    0.507
#&gt; Event|(Intercept)                               -3.076    0.626   -4.342
#&gt; Event|sexf                                      -0.322    0.626   -1.518
#&gt; Event|trt                                       -0.724    0.433   -1.600
#&gt; Event|b-splines-coef1                           -1.383    1.049   -3.740
#&gt; Event|b-splines-coef2                            0.131    0.923   -1.656
#&gt; Event|b-splines-coef3                           -1.638    1.148   -3.911
#&gt; Event|b-splines-coef4                            0.635    1.626   -2.581
#&gt; Event|b-splines-coef5                           -0.212    1.580   -3.302
#&gt; Event|b-splines-coef6                           -0.653    1.615   -3.966
#&gt; Assoc|Long1|etavalue                             1.466    0.303    0.948
#&gt; Sigma[id:Long1|(Intercept),Long1|(Intercept)]    1.720    0.432    1.086
#&gt; log-posterior                                 -378.689    7.032 -393.668
#&gt;                                                 25%      50%      75%   
#&gt; Long1|(Intercept)                                0.658    0.766    0.874
#&gt; Long1|year                                       0.086    0.092    0.098
#&gt; Long1|sigma                                      0.495    0.509    0.522
#&gt; Long1|mean_PPD                                   0.561    0.586    0.615
#&gt; Event|(Intercept)                               -3.467   -3.059   -2.671
#&gt; Event|sexf                                      -0.735   -0.327    0.028
#&gt; Event|trt                                       -1.053   -0.684   -0.421
#&gt; Event|b-splines-coef1                           -2.068   -1.349   -0.629
#&gt; Event|b-splines-coef2                           -0.509    0.136    0.794
#&gt; Event|b-splines-coef3                           -2.470   -1.644   -0.793
#&gt; Event|b-splines-coef4                           -0.356    0.545    1.800
#&gt; Event|b-splines-coef5                           -1.278   -0.188    0.888
#&gt; Event|b-splines-coef6                           -1.694   -0.520    0.444
#&gt; Assoc|Long1|etavalue                             1.274    1.448    1.654
#&gt; Sigma[id:Long1|(Intercept),Long1|(Intercept)]    1.408    1.648    1.978
#&gt; log-posterior                                 -383.244 -378.634 -373.699
#&gt;                                                 97.5% 
#&gt; Long1|(Intercept)                                1.103
#&gt; Long1|year                                       0.111
#&gt; Long1|sigma                                      0.552
#&gt; Long1|mean_PPD                                   0.666
#&gt; Event|(Intercept)                               -1.955
#&gt; Event|sexf                                       0.941
#&gt; Event|trt                                        0.069
#&gt; Event|b-splines-coef1                            0.538
#&gt; Event|b-splines-coef2                            1.901
#&gt; Event|b-splines-coef3                            0.562
#&gt; Event|b-splines-coef4                            3.628
#&gt; Event|b-splines-coef5                            2.659
#&gt; Event|b-splines-coef6                            2.238
#&gt; Assoc|Long1|etavalue                             2.124
#&gt; Sigma[id:Long1|(Intercept),Long1|(Intercept)]    2.725
#&gt; log-posterior                                 -365.707
#&gt; 
#&gt; Diagnostics:
#&gt;                                               mcse  Rhat  n_eff
#&gt; Long1|(Intercept)                             0.020 1.007  72  
#&gt; Long1|year                                    0.000 0.998 500  
#&gt; Long1|sigma                                   0.001 0.999 500  
#&gt; Long1|mean_PPD                                0.002 0.998 500  
#&gt; Event|(Intercept)                             0.028 1.001 500  
#&gt; Event|sexf                                    0.028 1.000 500  
#&gt; Event|trt                                     0.019 1.000 500  
#&gt; Event|b-splines-coef1                         0.052 1.002 405  
#&gt; Event|b-splines-coef2                         0.049 0.999 350  
#&gt; Event|b-splines-coef3                         0.068 1.001 288  
#&gt; Event|b-splines-coef4                         0.097 0.999 279  
#&gt; Event|b-splines-coef5                         0.089 0.998 312  
#&gt; Event|b-splines-coef6                         0.085 0.998 361  
#&gt; Assoc|Long1|etavalue                          0.016 1.001 381  
#&gt; Sigma[id:Long1|(Intercept),Long1|(Intercept)] 0.051 0.999  71  
#&gt; log-posterior                                 0.718 0.999  96  
#&gt; 
#&gt; For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</div><div class='input'>
<span class='co'>#####</span>
<span class='co'># Univariate joint model, with association structure based on the </span>
<span class='co'># current value and slope of the linear predictor</span>
<span class='no'>f2</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_jm</span>(<span class='kw'>formulaLong</span> <span class='kw'>=</span> <span class='no'>logBili</span> ~ <span class='no'>year</span> + (<span class='no'>year</span> <span class='kw'>|</span> <span class='no'>id</span>),
              <span class='kw'>dataLong</span> <span class='kw'>=</span> <span class='no'>pbcLong</span>,
              <span class='kw'>formulaEvent</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>futimeYears</span>, <span class='no'>death</span>) ~ <span class='no'>sex</span> + <span class='no'>trt</span>,
              <span class='kw'>dataEvent</span> <span class='kw'>=</span> <span class='no'>pbcSurv</span>,
              <span class='kw'>assoc</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"etavalue"</span>, <span class='st'>"etaslope"</span>),
              <span class='kw'>time_var</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
              <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; Fitting a univariate joint model.
#&gt; 
#&gt; Please note the warmup may be much slower than later iterations!
#&gt; 
#&gt; SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).
#&gt; 
#&gt; Gradient evaluation took 0.000836 seconds
#&gt; 1000 transitions using 10 leapfrog steps per transition would take 8.36 seconds.
#&gt; Adjust your expectations accordingly!
#&gt; 
#&gt; 
#&gt; Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt; 
#&gt;  Elapsed Time: 21.9209 seconds (Warm-up)
#&gt;                14.5988 seconds (Sampling)
#&gt;                36.5197 seconds (Total)
#&gt; </div><div class='input'><span class='fu'>print</span>(<span class='no'>f2</span>)</div><div class='output co'>#&gt; stan_jm
#&gt;  formula (Long1): logBili ~ year + (year | id)
#&gt;  family  (Long1): gaussian [identity]
#&gt;  formula (Event): Surv(futimeYears, death) ~ sex + trt
#&gt;  baseline hazard: bs
#&gt;  assoc:           etavalue (Long1), etaslope (Long1)
#&gt; ------
#&gt; 
#&gt; Longitudinal submodel: logBili
#&gt;             Median MAD_SD
#&gt; (Intercept) 0.647  0.194 
#&gt; year        0.259  0.050 
#&gt; sigma       0.356  0.017 
#&gt; 
#&gt; Event submodel:
#&gt;                 Median   MAD_SD   exp(Median)
#&gt; (Intercept)       -3.413    0.697    0.033   
#&gt; sexf              -0.427    0.585    0.653   
#&gt; trt               -0.982    0.604    0.374   
#&gt; Long1|etavalue     0.839    0.423    2.314   
#&gt; Long1|etaslope     9.011    5.037 8196.115   
#&gt; b-splines-coef1   -4.934    3.580       NA   
#&gt; b-splines-coef2   -2.084    1.942       NA   
#&gt; b-splines-coef3   -2.710    1.461       NA   
#&gt; b-splines-coef4   -0.382    1.798       NA   
#&gt; b-splines-coef5    0.168    1.783       NA   
#&gt; b-splines-coef6   -0.568    1.795       NA   
#&gt; 
#&gt; Group-level error terms:
#&gt;  Groups Name              Std.Dev. Corr
#&gt;  id     Long1|(Intercept) 1.2578       
#&gt;         Long1|year        0.2387   0.68
#&gt; Num. levels: id 40 
#&gt; 
#&gt; Sample avg. posterior predictive distribution 
#&gt; of longitudinal outcomes:
#&gt;                Median MAD_SD
#&gt; Long1|mean_PPD 0.587  0.027 
#&gt; 
#&gt; ------
#&gt; For info on the priors used see help('prior_summary.stanreg').</div><div class='input'>
<span class='co'>#####</span>
<span class='co'># Univariate joint model, with association structure based on the </span>
<span class='co'># lagged value of the linear predictor, where the lag is 2 time </span>
<span class='co'># units (i.e. 2 years in this example)</span>
<span class='no'>f3</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_jm</span>(<span class='kw'>formulaLong</span> <span class='kw'>=</span> <span class='no'>logBili</span> ~ <span class='no'>year</span> + (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>id</span>),
              <span class='kw'>dataLong</span> <span class='kw'>=</span> <span class='no'>pbcLong</span>,
              <span class='kw'>formulaEvent</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>futimeYears</span>, <span class='no'>death</span>) ~ <span class='no'>sex</span> + <span class='no'>trt</span>,
              <span class='kw'>dataEvent</span> <span class='kw'>=</span> <span class='no'>pbcSurv</span>,
              <span class='kw'>time_var</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
              <span class='kw'>assoc</span> <span class='kw'>=</span> <span class='st'>"etavalue"</span>, <span class='kw'>lag_assoc</span> <span class='kw'>=</span> <span class='fl'>2</span>,
              <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; Fitting a univariate joint model.
#&gt; 
#&gt; Please note the warmup may be much slower than later iterations!
#&gt; 
#&gt; SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).
#&gt; 
#&gt; Gradient evaluation took 0.000154 seconds
#&gt; 1000 transitions using 10 leapfrog steps per transition would take 1.54 seconds.
#&gt; Adjust your expectations accordingly!
#&gt; 
#&gt; 
#&gt; Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt; 
#&gt;  Elapsed Time: 3.99428 seconds (Warm-up)
#&gt;                2.74611 seconds (Sampling)
#&gt;                6.74038 seconds (Total)
#&gt; </div><div class='input'><span class='fu'>print</span>(<span class='no'>f3</span>)</div><div class='output co'>#&gt; stan_jm
#&gt;  formula (Long1): logBili ~ year + (1 | id)
#&gt;  family  (Long1): gaussian [identity]
#&gt;  formula (Event): Surv(futimeYears, death) ~ sex + trt
#&gt;  baseline hazard: bs
#&gt;  assoc:           etavalue (Long1)
#&gt; ------
#&gt; 
#&gt; Longitudinal submodel: logBili
#&gt;             Median MAD_SD
#&gt; (Intercept) 0.803  0.190 
#&gt; year        0.092  0.009 
#&gt; sigma       0.509  0.023 
#&gt; 
#&gt; Event submodel:
#&gt;                 Median MAD_SD exp(Median)
#&gt; (Intercept)     -2.948  0.683  0.052     
#&gt; sexf            -0.317  0.639  0.728     
#&gt; trt             -0.701  0.440  0.496     
#&gt; Long1|etavalue   1.452  0.268  4.274     
#&gt; b-splines-coef1 -1.447  1.072     NA     
#&gt; b-splines-coef2  0.192  0.889     NA     
#&gt; b-splines-coef3 -1.465  1.179     NA     
#&gt; b-splines-coef4  0.796  1.544     NA     
#&gt; b-splines-coef5  0.113  1.555     NA     
#&gt; b-splines-coef6 -0.357  1.630     NA     
#&gt; 
#&gt; Group-level error terms:
#&gt;  Groups Name              Std.Dev.
#&gt;  id     Long1|(Intercept) 1.348   
#&gt; Num. levels: id 40 
#&gt; 
#&gt; Sample avg. posterior predictive distribution 
#&gt; of longitudinal outcomes:
#&gt;                Median MAD_SD
#&gt; Long1|mean_PPD 0.584  0.041 
#&gt; 
#&gt; ------
#&gt; For info on the priors used see help('prior_summary.stanreg').</div><div class='input'>
<span class='co'>#####</span>
<span class='co'># Univariate joint model, where the association structure includes </span>
<span class='co'># interactions with observed data. Here we specify that we want to use </span>
<span class='co'># an association structure based on the current value of the linear </span>
<span class='co'># predictor from the longitudinal submodel (i.e. "etavalue"), but we </span>
<span class='co'># also want to interact this with the treatment covariate (trt) from</span>
<span class='co'># pbcLong data frame, so that we can estimate a different association </span>
<span class='co'># parameter (i.e. estimated effect of log serum bilirubin on the log </span>
<span class='co'># hazard of death) for each treatment group</span>
<span class='no'>f4</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_jm</span>(<span class='kw'>formulaLong</span> <span class='kw'>=</span> <span class='no'>logBili</span> ~ <span class='no'>year</span> + (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>id</span>),
              <span class='kw'>dataLong</span> <span class='kw'>=</span> <span class='no'>pbcLong</span>,
              <span class='kw'>formulaEvent</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>futimeYears</span>, <span class='no'>death</span>) ~ <span class='no'>sex</span> + <span class='no'>trt</span>,
              <span class='kw'>dataEvent</span> <span class='kw'>=</span> <span class='no'>pbcSurv</span>,
              <span class='kw'>time_var</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
              <span class='kw'>assoc</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"etavalue"</span>, <span class='st'>"etavalue_data(~ trt)"</span>),
              <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; Fitting a univariate joint model.
#&gt; 
#&gt; Please note the warmup may be much slower than later iterations!
#&gt; 
#&gt; SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).
#&gt; 
#&gt; Gradient evaluation took 0.000163 seconds
#&gt; 1000 transitions using 10 leapfrog steps per transition would take 1.63 seconds.
#&gt; Adjust your expectations accordingly!
#&gt; 
#&gt; 
#&gt; Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt; 
#&gt;  Elapsed Time: 4.25758 seconds (Warm-up)
#&gt;                2.8048 seconds (Sampling)
#&gt;                7.06238 seconds (Total)
#&gt; </div><div class='input'><span class='fu'>print</span>(<span class='no'>f4</span>)</div><div class='output co'>#&gt; stan_jm
#&gt;  formula (Long1): logBili ~ year + (1 | id)
#&gt;  family  (Long1): gaussian [identity]
#&gt;  formula (Event): Surv(futimeYears, death) ~ sex + trt
#&gt;  baseline hazard: bs
#&gt;  assoc:           etavalue (Long1), etavalue_data (Long1)
#&gt; ------
#&gt; 
#&gt; Longitudinal submodel: logBili
#&gt;             Median MAD_SD
#&gt; (Intercept) 0.855  0.228 
#&gt; year        0.093  0.009 
#&gt; sigma       0.509  0.020 
#&gt; 
#&gt; Event submodel:
#&gt;                    Median MAD_SD exp(Median)
#&gt; (Intercept)        -2.931  1.355  0.053     
#&gt; sexf               -0.335  0.556  0.716     
#&gt; trt                -0.729  0.459  0.482     
#&gt; Long1|etavalue      1.461  0.288  4.309     
#&gt; Long1|etavalue:trt -0.289  3.591  0.749     
#&gt; b-splines-coef1    -1.413  1.176     NA     
#&gt; b-splines-coef2     0.200  0.889     NA     
#&gt; b-splines-coef3    -1.820  1.174     NA     
#&gt; b-splines-coef4     0.951  1.488     NA     
#&gt; b-splines-coef5    -0.538  1.381     NA     
#&gt; b-splines-coef6    -0.176  1.577     NA     
#&gt; 
#&gt; Group-level error terms:
#&gt;  Groups Name              Std.Dev.
#&gt;  id     Long1|(Intercept) 1.355   
#&gt; Num. levels: id 40 
#&gt; 
#&gt; Sample avg. posterior predictive distribution 
#&gt; of longitudinal outcomes:
#&gt;                Median MAD_SD
#&gt; Long1|mean_PPD 0.587  0.043 
#&gt; 
#&gt; ------
#&gt; For info on the priors used see help('prior_summary.stanreg').</div><div class='input'>
<span class='co'>######</span>
<span class='co'># Multivariate joint model, with association structure based </span>
<span class='co'># on the current value and slope of the linear predictor in the </span>
<span class='co'># first longitudinal submodel and the area under the marker </span>
<span class='co'># trajectory for the second longitudinal submodel</span>
<span class='no'>mv1</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_jm</span>(
        <span class='kw'>formulaLong</span> <span class='kw'>=</span> <span class='fu'>list</span>(
          <span class='no'>logBili</span> ~ <span class='no'>year</span> + (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>id</span>),
          <span class='no'>albumin</span> ~ <span class='no'>sex</span> + <span class='no'>year</span> + (<span class='no'>year</span> <span class='kw'>|</span> <span class='no'>id</span>)),
        <span class='kw'>dataLong</span> <span class='kw'>=</span> <span class='no'>pbcLong</span>,
        <span class='kw'>formulaEvent</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>futimeYears</span>, <span class='no'>death</span>) ~ <span class='no'>sex</span> + <span class='no'>trt</span>,
        <span class='kw'>dataEvent</span> <span class='kw'>=</span> <span class='no'>pbcSurv</span>,
        <span class='kw'>assoc</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='fu'>c</span>(<span class='st'>"etavalue"</span>, <span class='st'>"etaslope"</span>), <span class='st'>"etaauc"</span>),
        <span class='kw'>time_var</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
        <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt; Fitting a multivariate joint model.
#&gt; 
#&gt; Please note the warmup may be much slower than later iterations!
#&gt; 
#&gt; SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).
#&gt; 
#&gt; Gradient evaluation took 0.002427 seconds
#&gt; 1000 transitions using 10 leapfrog steps per transition would take 24.27 seconds.
#&gt; Adjust your expectations accordingly!
#&gt; 
#&gt; 
#&gt; WARNING: There aren't enough warmup iterations to fit the
#&gt;          three stages of adaptation as currently configured.
#&gt;          Reducing each adaptation stage to 15%/75%/10% of
#&gt;          the given number of warmup iterations:
#&gt;            init_buffer = 7
#&gt;            adapt_window = 38
#&gt;            term_buffer = 5
#&gt; 
#&gt; Iteration:  1 / 100 [  1%]  (Warmup)
#&gt; Iteration: 10 / 100 [ 10%]  (Warmup)
#&gt; Iteration: 20 / 100 [ 20%]  (Warmup)
#&gt; Iteration: 30 / 100 [ 30%]  (Warmup)
#&gt; Iteration: 40 / 100 [ 40%]  (Warmup)
#&gt; Iteration: 50 / 100 [ 50%]  (Warmup)
#&gt; Iteration: 51 / 100 [ 51%]  (Sampling)
#&gt; Iteration: 60 / 100 [ 60%]  (Sampling)
#&gt; Iteration: 70 / 100 [ 70%]  (Sampling)
#&gt; Iteration: 80 / 100 [ 80%]  (Sampling)
#&gt; Iteration: 90 / 100 [ 90%]  (Sampling)
#&gt; Iteration: 100 / 100 [100%]  (Sampling)
#&gt; 
#&gt;  Elapsed Time: 21.3341 seconds (Warm-up)
#&gt;                0.332969 seconds (Sampling)
#&gt;                21.6671 seconds (Total)
#&gt; </div><div class='output co'>#&gt; <span class='warning'>Warning: There were 50 divergent transitions after warmup. Increasing adapt_delta above 0.85 may help. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Examine the pairs() plot to diagnose sampling problems</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Markov chains did not converge! Do not analyze results!</span></div><div class='input'><span class='fu'>print</span>(<span class='no'>mv1</span>)</div><div class='output co'>#&gt; stan_jm
#&gt;  formula (Long1): logBili ~ year + (1 | id)
#&gt;  family  (Long1): gaussian [identity]
#&gt;  formula (Long2): albumin ~ sex + year + (year | id)
#&gt;  family  (Long2): gaussian [identity]
#&gt;  formula (Event): Surv(futimeYears, death) ~ sex + trt
#&gt;  baseline hazard: bs
#&gt;  assoc:           etavalue (Long1), etaslope (Long1), etaauc (Long2)
#&gt; ------
#&gt; 
#&gt; Longitudinal submodel 1: logBili
#&gt;             Median MAD_SD
#&gt; (Intercept) 0.697  0.000 
#&gt; year        0.086  0.000 
#&gt; sigma       0.526  0.000 
#&gt; 
#&gt; Longitudinal submodel 2: albumin
#&gt;             Median MAD_SD
#&gt; (Intercept)  3.509  0.000
#&gt; sexf         0.081  0.000
#&gt; year        -0.123  0.000
#&gt; sigma        0.334  0.000
#&gt; 
#&gt; Event submodel:
#&gt;                 Median        MAD_SD        exp(Median)  
#&gt; (Intercept)     -9.103996e+10  1.230000e-01  0.000000e+00
#&gt; sexf            -3.470000e-01  0.000000e+00  7.070000e-01
#&gt; trt             -9.600000e-02  0.000000e+00  9.080000e-01
#&gt; Long1|etavalue   2.446000e+00  0.000000e+00  1.154700e+01
#&gt; Long1|etaslope   1.062678e+12  1.440000e+00           Inf
#&gt; Long2|etaauc    -3.520000e-01  0.000000e+00  7.040000e-01
#&gt; b-splines-coef1  0.000000e+00  0.000000e+00            NA
#&gt; b-splines-coef2  0.000000e+00  0.000000e+00            NA
#&gt; b-splines-coef3  0.000000e+00  0.000000e+00            NA
#&gt; b-splines-coef4  0.000000e+00  0.000000e+00            NA
#&gt; b-splines-coef5  0.000000e+00  0.000000e+00            NA
#&gt; b-splines-coef6  0.000000e+00  0.000000e+00            NA
#&gt; 
#&gt; Group-level error terms:
#&gt;  Groups Name              Std.Dev. Corr     
#&gt;  id     Long1|(Intercept) 1.11688           
#&gt;         Long2|(Intercept) 0.36463  0.00     
#&gt;         Long2|year        0.03419  0.00 0.00
#&gt; Num. levels: id 40 
#&gt; 
#&gt; Sample avg. posterior predictive distribution 
#&gt; of longitudinal outcomes:
#&gt;                Median MAD_SD
#&gt; Long1|mean_PPD 0.874  0.025 
#&gt; Long2|mean_PPD 3.141  0.019 
#&gt; 
#&gt; ------
#&gt; For info on the priors used see help('prior_summary.stanreg').</div><div class='input'>
<span class='co'>#####</span>
<span class='co'># Multivariate joint model, where the association structure is formed by </span>
<span class='co'># including the expected value of each longitudinal marker (logBili and </span>
<span class='co'># albumin) in the linear predictor of the event submodel, as well as their </span>
<span class='co'># interaction effect (i.e. the interaction between the two "etavalue" terms). </span>
<span class='co'># Note that whether such an association structure based on a marker by </span>
<span class='co'># marker interaction term makes sense will depend on the context of your </span>
<span class='co'># application -- here we just show it for demostration purposes).</span>
<span class='no'>mv2</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_jm</span>(
        <span class='kw'>formulaLong</span> <span class='kw'>=</span> <span class='fu'>list</span>(
          <span class='no'>logBili</span> ~ <span class='no'>year</span> + (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>id</span>),
          <span class='no'>albumin</span> ~ <span class='no'>sex</span> + <span class='no'>year</span> + (<span class='no'>year</span> <span class='kw'>|</span> <span class='no'>id</span>)),
        <span class='kw'>dataLong</span> <span class='kw'>=</span> <span class='no'>pbcLong</span>,
        <span class='kw'>formulaEvent</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>futimeYears</span>, <span class='no'>death</span>) ~ <span class='no'>sex</span> + <span class='no'>trt</span>,
        <span class='kw'>dataEvent</span> <span class='kw'>=</span> <span class='no'>pbcSurv</span>,
        <span class='kw'>assoc</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='fu'>c</span>(<span class='st'>"etavalue"</span>, <span class='st'>"etavalue_etavalue(2)"</span>), <span class='st'>"etavalue"</span>),
        <span class='kw'>time_var</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
        <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt; Fitting a multivariate joint model.
#&gt; 
#&gt; Please note the warmup may be much slower than later iterations!
#&gt; 
#&gt; SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).
#&gt; 
#&gt; Gradient evaluation took 0.000509 seconds
#&gt; 1000 transitions using 10 leapfrog steps per transition would take 5.09 seconds.
#&gt; Adjust your expectations accordingly!
#&gt; 
#&gt; 
#&gt; WARNING: There aren't enough warmup iterations to fit the
#&gt;          three stages of adaptation as currently configured.
#&gt;          Reducing each adaptation stage to 15%/75%/10% of
#&gt;          the given number of warmup iterations:
#&gt;            init_buffer = 7
#&gt;            adapt_window = 38
#&gt;            term_buffer = 5
#&gt; 
#&gt; Iteration:  1 / 100 [  1%]  (Warmup)
#&gt; Iteration: 10 / 100 [ 10%]  (Warmup)
#&gt; Iteration: 20 / 100 [ 20%]  (Warmup)
#&gt; Iteration: 30 / 100 [ 30%]  (Warmup)
#&gt; Iteration: 40 / 100 [ 40%]  (Warmup)
#&gt; Iteration: 50 / 100 [ 50%]  (Warmup)
#&gt; Iteration: 51 / 100 [ 51%]  (Sampling)
#&gt; Iteration: 60 / 100 [ 60%]  (Sampling)
#&gt; Iteration: 70 / 100 [ 70%]  (Sampling)
#&gt; Iteration: 80 / 100 [ 80%]  (Sampling)
#&gt; Iteration: 90 / 100 [ 90%]  (Sampling)
#&gt; Iteration: 100 / 100 [100%]  (Sampling)
#&gt; 
#&gt;  Elapsed Time: 3.94592 seconds (Warm-up)
#&gt;                9.85477 seconds (Sampling)
#&gt;                13.8007 seconds (Total)
#&gt; </div><div class='output co'>#&gt; <span class='warning'>Warning: There were 2 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Examine the pairs() plot to diagnose sampling problems</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Markov chains did not converge! Do not analyze results!</span></div><div class='input'>
<span class='co'>#####</span>
<span class='co'># Multivariate joint model, with one bernoulli marker and one</span>
<span class='co'># Gaussian marker. We will artificially create the bernoulli</span>
<span class='co'># marker by dichotomising log serum bilirubin</span>
<span class='no'>pbcLong</span>$<span class='no'>ybern</span> <span class='kw'>&lt;-</span> <span class='fu'>as.integer</span>(<span class='no'>pbcLong</span>$<span class='no'>logBili</span> <span class='kw'>&gt;=</span> <span class='fu'>mean</span>(<span class='no'>pbcLong</span>$<span class='no'>logBili</span>))
<span class='no'>mv3</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_jm</span>(
        <span class='kw'>formulaLong</span> <span class='kw'>=</span> <span class='fu'>list</span>(
          <span class='no'>ybern</span> ~ <span class='no'>year</span> + (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>id</span>),
          <span class='no'>albumin</span> ~ <span class='no'>sex</span> + <span class='no'>year</span> + (<span class='no'>year</span> <span class='kw'>|</span> <span class='no'>id</span>)),
        <span class='kw'>dataLong</span> <span class='kw'>=</span> <span class='no'>pbcLong</span>,
        <span class='kw'>formulaEvent</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>futimeYears</span>, <span class='no'>death</span>) ~ <span class='no'>sex</span> + <span class='no'>trt</span>,
        <span class='kw'>dataEvent</span> <span class='kw'>=</span> <span class='no'>pbcSurv</span>,
        <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='no'>binomial</span>, <span class='no'>gaussian</span>),
        <span class='kw'>time_var</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
        <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1000</span>)</div><div class='output co'>#&gt; Fitting a multivariate joint model.
#&gt; 
#&gt; Please note the warmup may be much slower than later iterations!
#&gt; 
#&gt; SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).
#&gt; 
#&gt; Gradient evaluation took 0.000352 seconds
#&gt; 1000 transitions using 10 leapfrog steps per transition would take 3.52 seconds.
#&gt; Adjust your expectations accordingly!
#&gt; 
#&gt; 
#&gt; Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt; 
#&gt;  Elapsed Time: 17.1106 seconds (Warm-up)
#&gt;                8.17647 seconds (Sampling)
#&gt;                25.287 seconds (Total)
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

