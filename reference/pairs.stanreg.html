<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pairs method for stanreg objects — pairs.stanreg • rstanarm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rstanarm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../Articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="https://htmlpreview.github.io/?https://github.com/stan-dev/rstanarm/blob/master/dev-notes/rstanarm_dev_notes.html">Develop</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/users/interfaces/rstan.html">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/users/interfaces/bayesplot.html">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/users/interfaces/shinystan.html">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/users/interfaces/loo.html">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/users/interfaces/rstantools.html">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/rstanarm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pairs method for stanreg objects</h1>
    </div>

    
    <p>Interface to <span class="pkg">bayesplot</span>'s <code><a href='http://www.rdocumentation.org/packages/bayesplot/topics/MCMC-scatterplots'>mcmc_pairs</a></code> function 
for use with <span class="pkg">rstanarm</span> models. Be careful not to specify too
many parameters to include or the plot will be both hard to read and slow to
render.</p>
    

    <pre class="usage"><span class='co'># S3 method for stanreg</span>
<span class='fu'>pairs</span>(<span class='no'>x</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>regex_pars</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A fitted model object returned by one of the 
<span class="pkg">rstanarm</span> modeling functions. See <code><a href='stanreg-objects.html'>stanreg-objects</a></code>.</p></td>
    </tr>
    <tr>
      <th>pars</th>
      <td><p>An optional character vetor of parameter names. All parameters 
are included by default, but for models with more than just a few 
parameters it may be far too many to visualize on a small computer screen 
and also may require substantial computing time.</p></td>
    </tr>
    <tr>
      <th>regex_pars</th>
      <td><p>An optional character vector of regular 
expressions to use for parameter selection. <code>regex_pars</code> can be used
in place of <code>pars</code> or in addition to <code>pars</code>. Currently, all
functions that accept a <code>regex_pars</code> argument ignore it for models fit
using optimization.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Optional arguments passed to <code><a href='http://www.rdocumentation.org/packages/bayesplot/topics/MCMC-scatterplots'>mcmc_pairs</a></code>. 
The <code>np</code>, <code>lp</code>, and <code>max_treedepth</code> arguments to 
<code>mcmc_pairs</code> are handled automatically by <span class="pkg">rstanarm</span> and do not 
need to be specified by the user in <code>...</code>. The arguments that can be 
specified in <code>...</code> include <code>transformations</code>, <code>diag_fun</code>,
<code>off_diag_fun</code>, <code>diag_args</code>, <code>off_diag_args</code>,
<code>condition</code>, and <code>np_style</code>. These arguments are
documented thoroughly on the help page for
<code><a href='http://www.rdocumentation.org/packages/bayesplot/topics/MCMC-scatterplots'>mcmc_pairs</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>By default, the <code>mcmc_pairs</code> function in the <span class="pkg">bayesplot</span> package 
plots some of the Markov chains (half, in the case of an even number of
chains) in the panels above the diagonal and the other half in the panels
below the diagonal. This can be changed using the <code>condition</code> argument
along with the <code>pairs_condition</code> helper function. 
We provide an example in the <span class="pkg">Examples</span> section, below, but 
for full details see the <code><a href='http://www.rdocumentation.org/packages/bayesplot/topics/MCMC-scatterplots'>mcmc_pairs</a></code> help page. 
In particular, if when you fit your model <span class="pkg">rstanarm</span> issues warnings 
about convergence, divergent transitions, or transitions hitting the maximum 
treedepth, then it can sometimes be useful to use one of the NUTS sampler 
parameters/diagnostics for <code>condition</code>. The last few examples below
demonstrate this feature.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (!<span class='fu'>exists</span>(<span class='st'>"example_model"</span>)) <span class='fu'>example</span>(<span class='no'>example_model</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: no help found for ‘example_model’</span></div><div class='input'>
<span class='kw'>bayesplot</span><span class='kw'>::</span><span class='fu'>color_scheme_set</span>(<span class='st'>"purple"</span>)
<span class='fu'>pairs</span>(<span class='no'>example_model</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"(Intercept)"</span>, <span class='st'>"log-posterior"</span>))</div><div class='output co'>#&gt; <span class='error'>Error in pairs(example_model, pars = c("(Intercept)", "log-posterior")): object 'example_model' not found</span></div><div class='input'>
<span class='fu'>pairs</span>(
  <span class='no'>example_model</span>,
  <span class='kw'>regex_pars</span> <span class='kw'>=</span> <span class='st'>"herd:[2,7,9]"</span>,
  <span class='kw'>diag_fun</span> <span class='kw'>=</span> <span class='st'>"dens"</span>,
  <span class='kw'>off_diag_fun</span> <span class='kw'>=</span> <span class='st'>"hex"</span>
)</div><div class='output co'>#&gt; <span class='error'>Error in pairs(example_model, regex_pars = "herd:[2,7,9]", diag_fun = "dens",     off_diag_fun = "hex"): object 'example_model' not found</span></div><div class='input'>


<span class='co'># for demonstration purposes, intentionally fit a model that</span>
<span class='co'># will (almost certainly) have some divergences</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stan_glm.html'>stan_glm</a></span>(
  <span class='no'>mpg</span> ~ <span class='no'>.</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mtcars</span>,
  <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='co'># this combo of prior and adapt_delta should lead to some divergences</span>
  <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>hs</a></span>(),
  <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='fl'>0.9</span>
)</div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
#&gt; 
#&gt; Chain 1, Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Chain 1, Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Chain 1, Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Chain 1, Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Chain 1, Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Chain 1, Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Chain 1, Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Chain 1, Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Chain 1, Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Chain 1, Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Chain 1, Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Chain 1, Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt;  Elapsed Time: 2.84858 seconds (Warm-up)
#&gt;                1.00898 seconds (Sampling)
#&gt;                3.85756 seconds (Total)
#&gt; 
#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
#&gt; 
#&gt; Chain 2, Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Chain 2, Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Chain 2, Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Chain 2, Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Chain 2, Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Chain 2, Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Chain 2, Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Chain 2, Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Chain 2, Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Chain 2, Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Chain 2, Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Chain 2, Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt;  Elapsed Time: 2.08817 seconds (Warm-up)
#&gt;                1.67026 seconds (Sampling)
#&gt;                3.75842 seconds (Total)
#&gt; 
#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
#&gt; 
#&gt; Chain 3, Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Chain 3, Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Chain 3, Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Chain 3, Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Chain 3, Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Chain 3, Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Chain 3, Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Chain 3, Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Chain 3, Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Chain 3, Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Chain 3, Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Chain 3, Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt;  Elapsed Time: 1.93254 seconds (Warm-up)
#&gt;                1.54725 seconds (Sampling)
#&gt;                3.47979 seconds (Total)
#&gt; 
#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
#&gt; 
#&gt; Chain 4, Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Chain 4, Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Chain 4, Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Chain 4, Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Chain 4, Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Chain 4, Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Chain 4, Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Chain 4, Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Chain 4, Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Chain 4, Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Chain 4, Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Chain 4, Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt;  Elapsed Time: 2.09995 seconds (Warm-up)
#&gt;                1.30974 seconds (Sampling)
#&gt;                3.40969 seconds (Total)
#&gt; </div><div class='output co'>#&gt; <span class='warning'>Warning: There were 283 divergent transitions after warmup. Increasing adapt_delta above 0.9 may help. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Examine the pairs() plot to diagnose sampling problems</span></div><div class='input'>
<span class='fu'>pairs</span>(
  <span class='no'>fit</span>,
  <span class='kw'>pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"wt"</span>, <span class='st'>"sigma"</span>, <span class='st'>"log-posterior"</span>),
  <span class='kw'>transformations</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>sigma</span> <span class='kw'>=</span> <span class='st'>"log"</span>), <span class='co'># show log(sigma) instead of sigma</span>
  <span class='kw'>off_diag_fun</span> <span class='kw'>=</span> <span class='st'>"hex"</span> <span class='co'># use hexagonal heatmaps instead of scatterplots</span>
)</div><img src='pairs.stanreg-12.png' alt='' width='540' height='400' /><div class='input'>

<span class='kw'>bayesplot</span><span class='kw'>::</span><span class='fu'>color_scheme_set</span>(<span class='st'>"brightblue"</span>)
<span class='fu'>pairs</span>(
  <span class='no'>fit</span>,
  <span class='kw'>pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"(Intercept)"</span>, <span class='st'>"wt"</span>, <span class='st'>"sigma"</span>, <span class='st'>"log-posterior"</span>),
  <span class='kw'>transformations</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>sigma</span> <span class='kw'>=</span> <span class='st'>"log"</span>),
  <span class='kw'>off_diag_args</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>3</span>/<span class='fl'>4</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>3</span>), <span class='co'># size and transparency of scatterplot points</span>
  <span class='kw'>np_style</span> <span class='kw'>=</span> <span class='fu'>pairs_style_np</span>(<span class='kw'>div_color</span> <span class='kw'>=</span> <span class='st'>"black"</span>, <span class='kw'>div_shape</span> <span class='kw'>=</span> <span class='fl'>2</span>) <span class='co'># color and shape of the divergences</span>
)</div><img src='pairs.stanreg-14.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># Using the condition argument to show divergences above the diagonal </span>
<span class='fu'>pairs</span>(
  <span class='no'>fit</span>,
  <span class='kw'>pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"(Intercept)"</span>, <span class='st'>"wt"</span>, <span class='st'>"log-posterior"</span>),
  <span class='kw'>condition</span> <span class='kw'>=</span> <span class='fu'>pairs_condition</span>(<span class='kw'>nuts</span> <span class='kw'>=</span> <span class='st'>"divergent__"</span>)
)</div><img src='pairs.stanreg-16.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># Using the condition argument to divide iterations by whether NUTS</span>
<span class='co'># accept_stat__ is at least the median accept_stat__ (above diagonal) or less</span>
<span class='co'># than the median accept_stat__ (below diagonal). divergences are still</span>
<span class='co'># marked in red.</span>
<span class='fu'>pairs</span>(
  <span class='no'>fit</span>,
  <span class='kw'>pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"(Intercept)"</span>, <span class='st'>"wt"</span>, <span class='st'>"log-posterior"</span>),
  <span class='kw'>condition</span> <span class='kw'>=</span> <span class='fu'>pairs_condition</span>(<span class='kw'>nuts</span> <span class='kw'>=</span> <span class='st'>"accept_stat__"</span>)
)</div><img src='pairs.stanreg-18.png' alt='' width='540' height='400' /><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
