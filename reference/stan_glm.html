<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian generalized linear models via Stan — stan_glm • rstanarm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rstanarm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="https://htmlpreview.github.io/?https://github.com/stan-dev/rstanarm/blob/master/dev-notes/rstanarm_dev_notes.html">Develop</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/users/interfaces/rstan.html">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/users/interfaces/bayesplot.html">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/users/interfaces/shinystan.html">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/users/interfaces/loo.html">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/users/interfaces/rstantools.html">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/rstanarm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian generalized linear models via Stan</h1>
    </div>

    
    <p>Generalized linear modeling with optional prior distributions for the
coefficients, intercept, and auxiliary parameters.</p>
    

    <pre class="usage"><span class='fu'>stan_glm</span>(<span class='no'>formula</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>gaussian</span>(), <span class='no'>data</span>, <span class='no'>weights</span>, <span class='no'>subset</span>,
  <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>cauchy</a></span>(<span class='fl'>0</span>, <span class='fl'>5</span>), <span class='kw'>prior_PD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sampling"</span>,
  <span class='st'>"optimizing"</span>, <span class='st'>"meanfield"</span>, <span class='st'>"fullrank"</span>), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>stan_glm.nb</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>weights</span>, <span class='no'>subset</span>, <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"log"</span>,
  <span class='no'>...</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>cauchy</a></span>(<span class='fl'>0</span>,
  <span class='fl'>5</span>), <span class='kw'>prior_PD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sampling"</span>, <span class='st'>"optimizing"</span>, <span class='st'>"meanfield"</span>,
  <span class='st'>"fullrank"</span>), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>stan_glm.fit</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>, <span class='fu'>NROW</span>(<span class='no'>x</span>)), <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fu'>NROW</span>(<span class='no'>x</span>)),
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>gaussian</span>(), <span class='no'>...</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(), <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(),
  <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>cauchy</a></span>(<span class='fl'>0</span>, <span class='fl'>5</span>), <span class='kw'>prior_ops</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'>list</span>(),
  <span class='kw'>prior_PD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"sampling"</span>, <span class='st'>"optimizing"</span>, <span class='st'>"meanfield"</span>,
  <span class='st'>"fullrank"</span>), <span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula, data, subset</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>, 
but <em>we strongly advise against omitting the <code>data</code>
argument</em>. Unless <code>data</code> is specified (and is a data frame) many
post-estimation functions (including <code>update</code>, <code>loo</code>,
<code>kfold</code>) are not guaranteed to work properly.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>, except negative binomial GLMs
are also possible using the <code><a href='neg_binomial_2.html'>neg_binomial_2</a></code> family object.</p></td>
    </tr>
    <tr>
      <th>na.action, contrasts</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>, but
rarely specified.</p></td>
    </tr>
    <tr>
      <th>model, offset, weights</th>
      <td><p>Same as <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>.</p></td>
    </tr>
    <tr>
      <th>x, y</th>
      <td><p>In <code>stan_glm, stan_glm.nb</code>, logical scalars indicating whether to
return the design matrix and response vector. In <code>stan_glm.fit</code>,
a design matrix and response vector.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to the function in the <span class="pkg">rstan</span> 
package (<code><a href='http://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-sampling'>sampling</a></code>, <code><a href='http://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-vb'>vb</a></code>, or 
<code><a href='http://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-optimizing'>optimizing</a></code>), corresponding to the estimation method 
named by <code>algorithm</code>. For example, if <code>algorithm</code> is
<code>"sampling"</code> it is possibly to specify <code>iter</code>, <code>chains</code>,
<code>cores</code>, <code>refresh</code>, etc.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>The prior distribution for the regression coefficients. 
<code>prior</code> should be a call to one of the various functions provided by 
<span class="pkg">rstanarm</span> for specifying priors. The subset of these functions that 
can be used for the prior on the coefficients can be grouped into several 
"families":</p><table><tr><td>
  <strong>Family</strong> </td>
<td> <strong>Functions</strong> </td>
</tr><tr><td> 
  <em>Student t family</em> </td>
<td> <code>normal</code>, <code>student_t</code>, <code>cauchy</code> </td>
</tr><tr><td> 
  <em>Hierarchical shrinkage family</em> </td>
<td> <code>hs</code>, <code>hs_plus</code> </td>
</tr><tr><td> 
  <em>Laplace family</em> </td>
<td> <code>laplace</code>, <code>lasso</code> </td>
</tr><tr><td>
  <em>Product normal family</em> </td>
<td> <code>product_normal</code> </td>
</tr></table>

<p>See the <a href='priors.html'>priors help page</a> for details on the families and 
how to specify the arguments for all of the functions in the table above.
To omit a prior ---i.e., to use a flat (improper) uniform prior---
<code>prior</code> can be set to <code>NULL</code>, although this is rarely a good
idea.

<strong>Note:</strong> Unless <code>QR=TRUE</code>, if <code>prior</code> is from the Student t
family or Laplace family, and if the <code>autoscale</code> argument to the 
function used to specify the prior (e.g. <code><a href='priors.html'>normal</a></code>) is left at 
its default and recommended value of <code>TRUE</code>, then the default or 
user-specified prior scale(s) may be adjusted internally based on the scales
of the predictors. See the <a href='priors.html'>priors help page</a> for details on
the rescaling and the <code><a href='prior_summary.stanreg.html'>prior_summary</a></code> function for a summary of
the priors used for a particular model.</p></td>
    </tr>
    <tr>
      <th>prior_intercept</th>
      <td><p>The prior distribution for the intercept. 
<code>prior_intercept</code> can be a call to <code>normal</code>, <code>student_t</code> or 
<code>cauchy</code>. See the <a href='priors.html'>priors help page</a> for details on 
these functions. To omit a prior on the intercept ---i.e., to use a flat
(improper) uniform prior--- <code>prior_intercept</code> can be set to
<code>NULL</code>.

<strong>Note:</strong> If using a dense representation of the design matrix 
---i.e., if the <code>sparse</code> argument is left at its default value of
<code>FALSE</code>--- then the prior distribution for the intercept is set so it
applies to the value when all predictors are centered. If you prefer to
specify a prior on the intercept without the predictors being auto-centered,
then you have to omit the intercept from the <code><a href='http://www.rdocumentation.org/packages/stats/topics/formula'>formula</a></code>
and include a column of ones as a predictor, in which case some element
of <code>prior</code> specifies the prior on it, rather than <code>prior_intercept</code>.</p></td>
    </tr>
    <tr>
      <th>prior_aux</th>
      <td><p>The prior distribution for the "auxiliary" parameter (if
applicable). The "auxiliary" parameter refers to a different parameter 
depending on the <code>family</code>. For Gaussian models <code>prior_aux</code> 
controls <code>"sigma"</code>, the error 
standard deviation. For negative binomial models <code>prior_aux</code> controls 
<code>"reciprocal_dispersion"</code>, which is similar to the 
<code>"size"</code> parameter of <code><a href='http://www.rdocumentation.org/packages/stats/topics/NegBinomial'>rnbinom</a></code>:
smaller values of <code>"reciprocal_dispersion"</code> correspond to 
greater dispersion. For gamma models <code>prior_aux</code> sets the prior on 
to the <code>"shape"</code> parameter (see e.g., 
<code><a href='http://www.rdocumentation.org/packages/stats/topics/GammaDist'>rgamma</a></code>), and for inverse-Gaussian models it is the 
so-called <code>"lambda"</code> parameter (which is essentially the reciprocal of
a scale parameter). Binomial and Poisson models do not have auxiliary 
parameters. 

<code>prior_aux</code> can be a call to <code>exponential</code> to 
use an exponential distribution, or <code>normal</code>, <code>student_t</code> or 
<code>cauchy</code>, which results in a half-normal, half-t, or half-Cauchy 
prior. See <code><a href='priors.html'>priors</a></code> for details on these functions. To omit a 
prior ---i.e., to use a flat (improper) uniform prior--- set 
<code>prior_aux</code> to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>prior_PD</th>
      <td><p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to draw from the prior predictive distribution instead of
conditioning on the outcome.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>A string (possibly abbreviated) indicating the 
estimation approach to use. Can be <code>"sampling"</code> for MCMC (the
default), <code>"optimizing"</code> for optimization, <code>"meanfield"</code> for
variational inference with independent normal distributions, or
<code>"fullrank"</code> for variational inference with a multivariate normal
distribution. See <code><a href='rstanarm-package.html'>rstanarm-package</a></code> for more details on the
estimation algorithms. NOTE: not all fitting functions support all four
algorithms.</p></td>
    </tr>
    <tr>
      <th>adapt_delta</th>
      <td><p>Only relevant if <code>algorithm="sampling"</code>. See 
<code><a href='adapt_delta.html'>adapt_delta</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>QR</th>
      <td><p>A logical scalar defaulting to <code>FALSE</code>, but if <code>TRUE</code> 
applies a scaled <code>qr</code> decomposition to the design matrix, 
\(X = Q^\ast R^\ast\), where \(Q^\ast = Q \sqrt{n-1}\) and \(R^\ast = \frac{1}{\sqrt{n-1}} R\). The coefficients relative to \(Q^\ast\) are obtained and then 
premultiplied by the inverse of \(R^{\ast}\) to obtain coefficients 
relative to the original predictors, \(X\). These transformations do not 
change the likelihood of the data but are recommended for computational 
reasons when there are multiple predictors. Importantly, while the columns
of \(X\) are almost always correlated, the columns of \(Q^\ast\)
are uncorrelated by design, which often makes sampling from the posterior
easier. However, because when <code>QR</code> is <code>TRUE</code> the <code>prior</code>
argument applies to the coefficients relative to \(Q^\ast\) (and
those are not very interpretable), setting <code>QR=TRUE</code> is only
recommended if you do not have an informative prior for the regression
coefficients.</p></td>
    </tr>
    <tr>
      <th>sparse</th>
      <td><p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to use a sparse representation of the design (X) matrix. 
Setting this to <code>TRUE</code> will likely be twice as slow, even if the
design matrix has a considerable number of zeros, but it may allow the
model to be estimated when the computer has too little RAM to
utilize a dense design matrix. If <code>TRUE</code>, the the design matrix
is not centered (since that would destroy the sparsity) and it is
not possible to specify both <code>QR = TRUE</code> and <code>sparse = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>For <code>stan_glm.nb</code> only, the link function to use. See 
<code><a href='neg_binomial_2.html'>neg_binomial_2</a></code>.</p></td>
    </tr>
    <tr>
      <th>prior_ops</th>
      <td><p>Deprecated. See <a href='rstanarm-deprecated.html'>rstanarm-deprecated</a> for details.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A list, possibly of length zero (the default), but otherwise
having the structure of that produced by <code><a href='http://www.rdocumentation.org/packages/lme4/topics/mkReTrms'>mkReTrms</a></code> to
indicate the group-specific part of the model. In addition, this list must
have elements for the <code>regularization</code>, <code>concentration</code> 
<code>shape</code>, and <code>scale</code> components of a <code><a href='priors.html'>decov</a></code>
prior for the covariance matrices among the group-specific coefficients.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='stanreg-objects.html'>stanreg</a> object is returned 
for <code>stan_glm, stan_glm.nb</code>.</p>
<p>A stanfit object (or a slightly modified 
  stanfit object) is returned if <code>stan_glm.fit</code> is called directly.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>stan_glm</code> function is similar in syntax to 
  <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code> but rather than performing maximum likelihood 
  estimation of generalized linear models, full Bayesian estimation is 
  performed (if <code>algorithm</code> is <code>"sampling"</code>) via MCMC. The Bayesian
  model adds priors (independent by default) on the coefficients of the GLM.
  The <code>stan_glm</code> function calls the workhorse <code>stan_glm.fit</code>
  function, but it is also possible to call the latter directly.
    The <code>stan_glm.nb</code> function, which takes the extra argument 
  <code>link</code>, is a wrapper for <code>stan_glm</code> with <code>family = 
  <a href='neg_binomial_2.html'>neg_binomial_2</a>(link)</code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gelman, A. and Hill, J. (2007). <em>Data Analysis Using
  Regression and Multilevel/Hierarchical Models.</em> Cambridge University Press,
  Cambridge, UK. (Ch. 3-6)</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='stanreg-methods.html'>stanreg-methods</a></code> and 
<code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code>.</p>
<p>The various vignettes for <code>stan_glm</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (!<span class='fu'>grepl</span>(<span class='st'>"^sparc"</span>,  <span class='no'>R.version</span>$<span class='no'>platform</span>)) {
<span class='co'>### Linear regression</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_glm</span>(<span class='no'>mpg</span> / <span class='fl'>10</span> ~ <span class='no'>.</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mtcars</span>, <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='st'>"fullrank"</span>) <span class='co'># for speed of example only</span>
<span class='fu'>plot</span>(<span class='no'>fit</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)
<span class='fu'>plot</span>(<span class='no'>fit</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='st'>"beta"</span>)
}</div><div class='output co'>#&gt; 
#&gt; This is Automatic Differentiation Variational Inference.
#&gt; 
#&gt; (EXPERIMENTAL ALGORITHM: expect frequent updates to the procedure.)
#&gt; 
#&gt; Gradient evaluation took 1.4e-05 seconds
#&gt; 1000 iterations under these settings should take 0.014 seconds.
#&gt; Adjust your expectations accordingly!
#&gt; 
#&gt; Begin eta adaptation.
#&gt; Iteration:   1 / 250 [  0%]  (Adaptation)
#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation)
#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation)
#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation)
#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation)
#&gt; Iteration: 250 / 250 [100%]  (Adaptation)
#&gt; Success! Found best value [eta = 0.1].
#&gt; 
#&gt; Begin stochastic gradient ascent.
#&gt;   iter       ELBO   delta_ELBO_mean   delta_ELBO_med   notes 
#&gt;    100     -1e+02             1.000            1.000
#&gt;    200     -1e+02             0.603            1.000
#&gt;    300     -9e+01             0.437            0.207
#&gt;    400     -8e+01             0.342            0.207
#&gt;    500     -8e+01             0.293            0.105
#&gt;    600     -7e+01             0.255            0.105
#&gt;    700     -7e+01             0.232            0.098
#&gt;    800     -6e+01             0.214            0.098
#&gt;    900     -6e+01             0.197            0.094
#&gt;   1000     -5e+01             0.184            0.094
#&gt;   1100     -5e+01             0.091            0.093
#&gt;   1200     -5e+01             0.075            0.074
#&gt;   1300     -5e+01             0.069            0.066
#&gt;   1400     -4e+01             0.066            0.066
#&gt;   1500     -4e+01             0.058            0.060
#&gt;   1600     -4e+01             0.053            0.060
#&gt;   1700     -4e+01             0.047            0.045
#&gt;   1800     -4e+01             0.041            0.038
#&gt;   1900     -4e+01             0.035            0.035
#&gt;   2000     -4e+01             0.029            0.033
#&gt;   2100     -4e+01             0.022            0.030
#&gt;   2200     -4e+01             0.018            0.016
#&gt;   2300     -4e+01             0.015            0.012
#&gt;   2400     -4e+01             0.013            0.012
#&gt;   2500     -4e+01             0.013            0.011
#&gt;   2600     -4e+01             0.012            0.008   MEDIAN ELBO CONVERGED
#&gt; 
#&gt; Drawing a sample of size 1000 from the approximate posterior... 
#&gt; COMPLETED.</div><img src='stan_glm-3.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'>### Logistic regression</span>
<span class='fu'>head</span>(<span class='no'>wells</span>)</div><div class='output co'>#&gt;   switch arsenic   dist assoc educ
#&gt; 1      1    2.36 16.826     0    0
#&gt; 2      1    0.71 47.322     0    0
#&gt; 3      0    2.07 20.967     0   10
#&gt; 4      1    1.15 21.486     0   12
#&gt; 5      1    1.10 40.874     1   14
#&gt; 6      1    3.90 69.518     1    9</div><div class='input'><span class='no'>wells</span>$<span class='no'>dist100</span> <span class='kw'>&lt;-</span> <span class='no'>wells</span>$<span class='no'>dist</span> / <span class='fl'>100</span>
<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_glm</span>(
  <span class='no'>switch</span> ~ <span class='no'>dist100</span> + <span class='no'>arsenic</span>,
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>wells</span>,
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>binomial</span>(<span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>),
  <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(<span class='fl'>0</span>, <span class='fl'>10</span>),
  <span class='kw'>QR</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>200</span> <span class='co'># for speed of example only</span>
)</div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'bernoulli' NOW (CHAIN 1).
#&gt; WARNING: The initial buffer, adaptation window, and terminal buffer
#&gt;          overflow the total number of warmup iterations.
#&gt;          Defaulting to a 15%/75%/10% partition,
#&gt;            init_buffer = 15
#&gt;            adapt_window = 75
#&gt;            term_buffer = 10
#&gt; 
#&gt; 
#&gt; Chain 1, Iteration:   1 / 200 [  0%]  (Warmup)
#&gt; Chain 1, Iteration:  20 / 200 [ 10%]  (Warmup)
#&gt; Chain 1, Iteration:  40 / 200 [ 20%]  (Warmup)
#&gt; Chain 1, Iteration:  60 / 200 [ 30%]  (Warmup)
#&gt; Chain 1, Iteration:  80 / 200 [ 40%]  (Warmup)
#&gt; Chain 1, Iteration: 100 / 200 [ 50%]  (Warmup)
#&gt; Chain 1, Iteration: 101 / 200 [ 50%]  (Sampling)
#&gt; Chain 1, Iteration: 120 / 200 [ 60%]  (Sampling)
#&gt; Chain 1, Iteration: 140 / 200 [ 70%]  (Sampling)
#&gt; Chain 1, Iteration: 160 / 200 [ 80%]  (Sampling)
#&gt; Chain 1, Iteration: 180 / 200 [ 90%]  (Sampling)
#&gt; Chain 1, Iteration: 200 / 200 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.434752 seconds (Warm-up)
#&gt;                0.283077 seconds (Sampling)
#&gt;                0.717829 seconds (Total)
#&gt; 
#&gt; 
#&gt; SAMPLING FOR MODEL 'bernoulli' NOW (CHAIN 2).
#&gt; WARNING: The initial buffer, adaptation window, and terminal buffer
#&gt;          overflow the total number of warmup iterations.
#&gt;          Defaulting to a 15%/75%/10% partition,
#&gt;            init_buffer = 15
#&gt;            adapt_window = 75
#&gt;            term_buffer = 10
#&gt; 
#&gt; 
#&gt; Chain 2, Iteration:   1 / 200 [  0%]  (Warmup)
#&gt; Chain 2, Iteration:  20 / 200 [ 10%]  (Warmup)
#&gt; Chain 2, Iteration:  40 / 200 [ 20%]  (Warmup)
#&gt; Chain 2, Iteration:  60 / 200 [ 30%]  (Warmup)
#&gt; Chain 2, Iteration:  80 / 200 [ 40%]  (Warmup)
#&gt; Chain 2, Iteration: 100 / 200 [ 50%]  (Warmup)
#&gt; Chain 2, Iteration: 101 / 200 [ 50%]  (Sampling)
#&gt; Chain 2, Iteration: 120 / 200 [ 60%]  (Sampling)
#&gt; Chain 2, Iteration: 140 / 200 [ 70%]  (Sampling)
#&gt; Chain 2, Iteration: 160 / 200 [ 80%]  (Sampling)
#&gt; Chain 2, Iteration: 180 / 200 [ 90%]  (Sampling)
#&gt; Chain 2, Iteration: 200 / 200 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.259841 seconds (Warm-up)
#&gt;                0.302613 seconds (Sampling)
#&gt;                0.562454 seconds (Total)
#&gt; </div><div class='input'><span class='fu'>print</span>(<span class='no'>fit2</span>)</div><div class='output co'>#&gt; stan_glm
#&gt;  family:   binomial [logit]
#&gt;  formula:  switch ~ dist100 + arsenic
#&gt;  num. obs: 3020
#&gt; ------
#&gt; 
#&gt; Estimates:
#&gt;             Median MAD_SD
#&gt; (Intercept)  0.0    0.1  
#&gt; dist100     -0.9    0.1  
#&gt; arsenic      0.5    0.0  
#&gt; 
#&gt; Sample avg. posterior predictive 
#&gt; distribution of y (X = xbar):
#&gt;          Median MAD_SD
#&gt; mean_PPD 0.6    0.0   
#&gt; 
#&gt; ------
#&gt; For info on the priors used see help('prior_summary.stanreg').</div><div class='input'><span class='fu'><a href='prior_summary.stanreg.html'>prior_summary</a></span>(<span class='no'>fit2</span>)</div><div class='output co'>#&gt; Priors for model 'fit2' 
#&gt; ------
#&gt; Intercept (after predictors centered)
#&gt;  ~ normal(location = 0, scale = 10)
#&gt; 
#&gt; Coefficients (in Q-space)
#&gt;  ~ normal(location = [0,0], scale = [2.5,2.5])
#&gt; ------
#&gt; See help('prior_summary.stanreg') for more details</div><div class='input'>
<span class='fu'>plot</span>(<span class='no'>fit2</span>, <span class='kw'>plotfun</span> <span class='kw'>=</span> <span class='st'>"areas"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='co'># ?bayesplot::mcmc_areas</span>
     <span class='kw'>pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"(Intercept)"</span>, <span class='st'>"arsenic"</span>))</div><img src='stan_glm-13.png' alt='' width='540' height='400' /><div class='input'><span class='fu'><a href='pp_check.stanreg.html'>pp_check</a></span>(<span class='no'>fit2</span>, <span class='kw'>plotfun</span> <span class='kw'>=</span> <span class='st'>"error_binned"</span>)  <span class='co'># ?bayesplot::ppc_error_binned</span></div><img src='stan_glm-15.png' alt='' width='540' height='400' /><div class='input'>

<span class='co'>### Poisson regression (example from help("glm")) </span>
<span class='no'>counts</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>18</span>,<span class='fl'>17</span>,<span class='fl'>15</span>,<span class='fl'>20</span>,<span class='fl'>10</span>,<span class='fl'>20</span>,<span class='fl'>25</span>,<span class='fl'>13</span>,<span class='fl'>12</span>)
<span class='no'>outcome</span> <span class='kw'>&lt;-</span> <span class='fu'>gl</span>(<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>9</span>)
<span class='no'>treatment</span> <span class='kw'>&lt;-</span> <span class='fu'>gl</span>(<span class='fl'>3</span>,<span class='fl'>3</span>)
<span class='no'>fit3</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_glm</span>(<span class='no'>counts</span> ~ <span class='no'>outcome</span> + <span class='no'>treatment</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>poisson</span>(<span class='kw'>link</span><span class='kw'>=</span><span class='st'>"log"</span>),
                 <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>prior_intercept</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>normal</a></span>(<span class='fl'>0</span>, <span class='fl'>5</span>),
                 <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>250</span>) <span class='co'># for speed of example only</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Omitting the 'data' argument is not recommended and may not be allowed in future versions of rstanarm. Some post-estimation functions (in particular 'update', 'loo', 'kfold') are not guaranteed to work properly unless 'data' is specified as a data frame.</span></div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'count' NOW (CHAIN 1).
#&gt; WARNING: The initial buffer, adaptation window, and terminal buffer
#&gt;          overflow the total number of warmup iterations.
#&gt;          Defaulting to a 15%/75%/10% partition,
#&gt;            init_buffer = 18
#&gt;            adapt_window = 95
#&gt;            term_buffer = 12
#&gt; 
#&gt; 
#&gt; Chain 1, Iteration:   1 / 250 [  0%]  (Warmup)
#&gt; Chain 1, Iteration:  25 / 250 [ 10%]  (Warmup)
#&gt; Chain 1, Iteration:  50 / 250 [ 20%]  (Warmup)
#&gt; Chain 1, Iteration:  75 / 250 [ 30%]  (Warmup)
#&gt; Chain 1, Iteration: 100 / 250 [ 40%]  (Warmup)
#&gt; Chain 1, Iteration: 125 / 250 [ 50%]  (Warmup)
#&gt; Chain 1, Iteration: 126 / 250 [ 50%]  (Sampling)
#&gt; Chain 1, Iteration: 150 / 250 [ 60%]  (Sampling)
#&gt; Chain 1, Iteration: 175 / 250 [ 70%]  (Sampling)
#&gt; Chain 1, Iteration: 200 / 250 [ 80%]  (Sampling)
#&gt; Chain 1, Iteration: 225 / 250 [ 90%]  (Sampling)
#&gt; Chain 1, Iteration: 250 / 250 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.007114 seconds (Warm-up)
#&gt;                0.009008 seconds (Sampling)
#&gt;                0.016122 seconds (Total)
#&gt; 
#&gt; 
#&gt; SAMPLING FOR MODEL 'count' NOW (CHAIN 2).
#&gt; WARNING: The initial buffer, adaptation window, and terminal buffer
#&gt;          overflow the total number of warmup iterations.
#&gt;          Defaulting to a 15%/75%/10% partition,
#&gt;            init_buffer = 18
#&gt;            adapt_window = 95
#&gt;            term_buffer = 12
#&gt; 
#&gt; 
#&gt; Chain 2, Iteration:   1 / 250 [  0%]  (Warmup)
#&gt; Chain 2, Iteration:  25 / 250 [ 10%]  (Warmup)
#&gt; Chain 2, Iteration:  50 / 250 [ 20%]  (Warmup)
#&gt; Chain 2, Iteration:  75 / 250 [ 30%]  (Warmup)
#&gt; Chain 2, Iteration: 100 / 250 [ 40%]  (Warmup)
#&gt; Chain 2, Iteration: 125 / 250 [ 50%]  (Warmup)
#&gt; Chain 2, Iteration: 126 / 250 [ 50%]  (Sampling)
#&gt; Chain 2, Iteration: 150 / 250 [ 60%]  (Sampling)
#&gt; Chain 2, Iteration: 175 / 250 [ 70%]  (Sampling)
#&gt; Chain 2, Iteration: 200 / 250 [ 80%]  (Sampling)
#&gt; Chain 2, Iteration: 225 / 250 [ 90%]  (Sampling)
#&gt; Chain 2, Iteration: 250 / 250 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.006928 seconds (Warm-up)
#&gt;                0.00819 seconds (Sampling)
#&gt;                0.015118 seconds (Total)
#&gt; </div><div class='input'><span class='fu'>print</span>(<span class='no'>fit3</span>)</div><div class='output co'>#&gt; stan_glm
#&gt;  family:   poisson [log]
#&gt;  formula:  counts ~ outcome + treatment
#&gt;  num. obs: 9
#&gt; ------
#&gt; 
#&gt; Estimates:
#&gt;             Median MAD_SD
#&gt; (Intercept)  3.0    0.2  
#&gt; outcome2    -0.4    0.2  
#&gt; outcome3    -0.3    0.2  
#&gt; treatment2   0.0    0.2  
#&gt; treatment3   0.0    0.2  
#&gt; 
#&gt; Sample avg. posterior predictive 
#&gt; distribution of y (X = xbar):
#&gt;          Median MAD_SD
#&gt; mean_PPD 16.7    2.0  
#&gt; 
#&gt; ------
#&gt; For info on the priors used see help('prior_summary.stanreg').</div><div class='input'>
<span class='kw'>bayesplot</span><span class='kw'>::</span><span class='fu'>color_scheme_set</span>(<span class='st'>"green"</span>)
<span class='fu'>plot</span>(<span class='no'>fit3</span>)</div><img src='stan_glm-22.png' alt='' width='540' height='400' /><div class='input'><span class='fu'>plot</span>(<span class='no'>fit3</span>, <span class='kw'>regex_pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"outcome"</span>, <span class='st'>"treatment"</span>))</div><img src='stan_glm-24.png' alt='' width='540' height='400' /><div class='input'><span class='fu'>plot</span>(<span class='no'>fit3</span>, <span class='kw'>plotfun</span> <span class='kw'>=</span> <span class='st'>"combo"</span>, <span class='kw'>regex_pars</span> <span class='kw'>=</span> <span class='st'>"treatment"</span>) <span class='co'># ?bayesplot::mcmc_combo</span></div><img src='stan_glm-26.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'>### Gamma regression (example from help("glm"))</span>
<span class='no'>clotting</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>log_u</span> <span class='kw'>=</span> <span class='fu'>log</span>(<span class='fu'>c</span>(<span class='fl'>5</span>,<span class='fl'>10</span>,<span class='fl'>15</span>,<span class='fl'>20</span>,<span class='fl'>30</span>,<span class='fl'>40</span>,<span class='fl'>60</span>,<span class='fl'>80</span>,<span class='fl'>100</span>)),
                       <span class='kw'>lot1</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>118</span>,<span class='fl'>58</span>,<span class='fl'>42</span>,<span class='fl'>35</span>,<span class='fl'>27</span>,<span class='fl'>25</span>,<span class='fl'>21</span>,<span class='fl'>19</span>,<span class='fl'>18</span>),
                       <span class='kw'>lot2</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>69</span>,<span class='fl'>35</span>,<span class='fl'>26</span>,<span class='fl'>21</span>,<span class='fl'>18</span>,<span class='fl'>16</span>,<span class='fl'>13</span>,<span class='fl'>12</span>,<span class='fl'>12</span>))
<span class='no'>fit4</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_glm</span>(<span class='no'>lot1</span> ~ <span class='no'>log_u</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>clotting</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>Gamma</span>(<span class='kw'>link</span><span class='kw'>=</span><span class='st'>"log"</span>),
                 <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>300</span>) <span class='co'># for speed of example only </span></div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
#&gt; 
#&gt; Chain 1, Iteration:   1 / 300 [  0%]  (Warmup)
#&gt; Chain 1, Iteration:  30 / 300 [ 10%]  (Warmup)
#&gt; Chain 1, Iteration:  60 / 300 [ 20%]  (Warmup)
#&gt; Chain 1, Iteration:  90 / 300 [ 30%]  (Warmup)
#&gt; Chain 1, Iteration: 120 / 300 [ 40%]  (Warmup)
#&gt; Chain 1, Iteration: 150 / 300 [ 50%]  (Warmup)
#&gt; Chain 1, Iteration: 151 / 300 [ 50%]  (Sampling)
#&gt; Chain 1, Iteration: 180 / 300 [ 60%]  (Sampling)
#&gt; Chain 1, Iteration: 210 / 300 [ 70%]  (Sampling)
#&gt; Chain 1, Iteration: 240 / 300 [ 80%]  (Sampling)
#&gt; Chain 1, Iteration: 270 / 300 [ 90%]  (Sampling)
#&gt; Chain 1, Iteration: 300 / 300 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.014394 seconds (Warm-up)
#&gt;                0.007179 seconds (Sampling)
#&gt;                0.021573 seconds (Total)
#&gt; 
#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
#&gt; 
#&gt; Chain 2, Iteration:   1 / 300 [  0%]  (Warmup)
#&gt; Chain 2, Iteration:  30 / 300 [ 10%]  (Warmup)
#&gt; Chain 2, Iteration:  60 / 300 [ 20%]  (Warmup)
#&gt; Chain 2, Iteration:  90 / 300 [ 30%]  (Warmup)
#&gt; Chain 2, Iteration: 120 / 300 [ 40%]  (Warmup)
#&gt; Chain 2, Iteration: 150 / 300 [ 50%]  (Warmup)
#&gt; Chain 2, Iteration: 151 / 300 [ 50%]  (Sampling)
#&gt; Chain 2, Iteration: 180 / 300 [ 60%]  (Sampling)
#&gt; Chain 2, Iteration: 210 / 300 [ 70%]  (Sampling)
#&gt; Chain 2, Iteration: 240 / 300 [ 80%]  (Sampling)
#&gt; Chain 2, Iteration: 270 / 300 [ 90%]  (Sampling)
#&gt; Chain 2, Iteration: 300 / 300 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.015684 seconds (Warm-up)
#&gt;                0.00611 seconds (Sampling)
#&gt;                0.021794 seconds (Total)
#&gt; </div><div class='input'><span class='fu'>print</span>(<span class='no'>fit4</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; stan_glm
#&gt;  family:   Gamma [log]
#&gt;  formula:  lot1 ~ log_u
#&gt;  num. obs: 9
#&gt; ------
#&gt; 
#&gt; Estimates:
#&gt;             Median MAD_SD
#&gt; (Intercept)  5.49   0.25 
#&gt; log_u       -0.60   0.08 
#&gt; shape       25.88  15.36 
#&gt; 
#&gt; Sample avg. posterior predictive 
#&gt; distribution of y (X = xbar):
#&gt;          Median MAD_SD
#&gt; mean_PPD 39.69   3.75 
#&gt; 
#&gt; ------
#&gt; For info on the priors used see help('prior_summary.stanreg').</div><div class='input'><span class='no'>fit5</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>fit4</span>, <span class='kw'>formula</span> <span class='kw'>=</span> <span class='no'>lot2</span> ~ <span class='no'>log_u</span>)</div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
#&gt; 
#&gt; Chain 1, Iteration:   1 / 300 [  0%]  (Warmup)
#&gt; Chain 1, Iteration:  30 / 300 [ 10%]  (Warmup)
#&gt; Chain 1, Iteration:  60 / 300 [ 20%]  (Warmup)
#&gt; Chain 1, Iteration:  90 / 300 [ 30%]  (Warmup)
#&gt; Chain 1, Iteration: 120 / 300 [ 40%]  (Warmup)
#&gt; Chain 1, Iteration: 150 / 300 [ 50%]  (Warmup)
#&gt; Chain 1, Iteration: 151 / 300 [ 50%]  (Sampling)
#&gt; Chain 1, Iteration: 180 / 300 [ 60%]  (Sampling)
#&gt; Chain 1, Iteration: 210 / 300 [ 70%]  (Sampling)
#&gt; Chain 1, Iteration: 240 / 300 [ 80%]  (Sampling)
#&gt; Chain 1, Iteration: 270 / 300 [ 90%]  (Sampling)
#&gt; Chain 1, Iteration: 300 / 300 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.022572 seconds (Warm-up)
#&gt;                0.006866 seconds (Sampling)
#&gt;                0.029438 seconds (Total)
#&gt; 
#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
#&gt; 
#&gt; Chain 2, Iteration:   1 / 300 [  0%]  (Warmup)
#&gt; Chain 2, Iteration:  30 / 300 [ 10%]  (Warmup)
#&gt; Chain 2, Iteration:  60 / 300 [ 20%]  (Warmup)
#&gt; Chain 2, Iteration:  90 / 300 [ 30%]  (Warmup)
#&gt; Chain 2, Iteration: 120 / 300 [ 40%]  (Warmup)
#&gt; Chain 2, Iteration: 150 / 300 [ 50%]  (Warmup)
#&gt; Chain 2, Iteration: 151 / 300 [ 50%]  (Sampling)
#&gt; Chain 2, Iteration: 180 / 300 [ 60%]  (Sampling)
#&gt; Chain 2, Iteration: 210 / 300 [ 70%]  (Sampling)
#&gt; Chain 2, Iteration: 240 / 300 [ 80%]  (Sampling)
#&gt; Chain 2, Iteration: 270 / 300 [ 90%]  (Sampling)
#&gt; Chain 2, Iteration: 300 / 300 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.014325 seconds (Warm-up)
#&gt;                0.007675 seconds (Sampling)
#&gt;                0.022 seconds (Total)
#&gt; </div><div class='input'>
<span class='co'>### Negative binomial regression</span>
<span class='no'>fit6</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_glm.nb</span>(<span class='no'>Days</span> ~ <span class='no'>Sex</span>/(<span class='no'>Age</span> + <span class='no'>Eth</span>*<span class='no'>Lrn</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>MASS</span><span class='kw'>::</span><span class='no'>quine</span>,
                    <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"log"</span>, <span class='kw'>prior_aux</span> <span class='kw'>=</span> <span class='fu'><a href='priors.html'>exponential</a></span>(<span class='fl'>1</span>),
                    <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>200</span>) <span class='co'># for speed of example only</span></div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'count' NOW (CHAIN 1).
#&gt; WARNING: The initial buffer, adaptation window, and terminal buffer
#&gt;          overflow the total number of warmup iterations.
#&gt;          Defaulting to a 15%/75%/10% partition,
#&gt;            init_buffer = 15
#&gt;            adapt_window = 75
#&gt;            term_buffer = 10
#&gt; 
#&gt; 
#&gt; Chain 1, Iteration:   1 / 200 [  0%]  (Warmup)
#&gt; Chain 1, Iteration:  20 / 200 [ 10%]  (Warmup)
#&gt; Chain 1, Iteration:  40 / 200 [ 20%]  (Warmup)
#&gt; Chain 1, Iteration:  60 / 200 [ 30%]  (Warmup)
#&gt; Chain 1, Iteration:  80 / 200 [ 40%]  (Warmup)
#&gt; Chain 1, Iteration: 100 / 200 [ 50%]  (Warmup)
#&gt; Chain 1, Iteration: 101 / 200 [ 50%]  (Sampling)
#&gt; Chain 1, Iteration: 120 / 200 [ 60%]  (Sampling)
#&gt; Chain 1, Iteration: 140 / 200 [ 70%]  (Sampling)
#&gt; Chain 1, Iteration: 160 / 200 [ 80%]  (Sampling)
#&gt; Chain 1, Iteration: 180 / 200 [ 90%]  (Sampling)
#&gt; Chain 1, Iteration: 200 / 200 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.225836 seconds (Warm-up)
#&gt;                0.222426 seconds (Sampling)
#&gt;                0.448262 seconds (Total)
#&gt; 
#&gt; 
#&gt; SAMPLING FOR MODEL 'count' NOW (CHAIN 2).
#&gt; WARNING: The initial buffer, adaptation window, and terminal buffer
#&gt;          overflow the total number of warmup iterations.
#&gt;          Defaulting to a 15%/75%/10% partition,
#&gt;            init_buffer = 15
#&gt;            adapt_window = 75
#&gt;            term_buffer = 10
#&gt; 
#&gt; 
#&gt; Chain 2, Iteration:   1 / 200 [  0%]  (Warmup)
#&gt; Chain 2, Iteration:  20 / 200 [ 10%]  (Warmup)
#&gt; Chain 2, Iteration:  40 / 200 [ 20%]  (Warmup)
#&gt; Chain 2, Iteration:  60 / 200 [ 30%]  (Warmup)
#&gt; Chain 2, Iteration:  80 / 200 [ 40%]  (Warmup)
#&gt; Chain 2, Iteration: 100 / 200 [ 50%]  (Warmup)
#&gt; Chain 2, Iteration: 101 / 200 [ 50%]  (Sampling)
#&gt; Chain 2, Iteration: 120 / 200 [ 60%]  (Sampling)
#&gt; Chain 2, Iteration: 140 / 200 [ 70%]  (Sampling)
#&gt; Chain 2, Iteration: 160 / 200 [ 80%]  (Sampling)
#&gt; Chain 2, Iteration: 180 / 200 [ 90%]  (Sampling)
#&gt; Chain 2, Iteration: 200 / 200 [100%]  (Sampling)
#&gt;  Elapsed Time: 0.205817 seconds (Warm-up)
#&gt;                0.245262 seconds (Sampling)
#&gt;                0.451079 seconds (Total)
#&gt; </div><div class='input'>
<span class='fu'><a href='prior_summary.stanreg.html'>prior_summary</a></span>(<span class='no'>fit6</span>)</div><div class='output co'>#&gt; Priors for model 'fit6' 
#&gt; ------
#&gt; Intercept (after predictors centered)
#&gt;  ~ normal(location = 0, scale = 10)
#&gt; 
#&gt; Coefficients
#&gt;  ~ normal(location = [0,0,0,...], scale = [2.5,2.5,2.5,...])
#&gt; 
#&gt; Auxiliary (reciprocal_dispersion)
#&gt;  ~ exponential(rate = 1)
#&gt; ------
#&gt; See help('prior_summary.stanreg') for more details</div><div class='input'><span class='kw'>bayesplot</span><span class='kw'>::</span><span class='fu'>color_scheme_set</span>(<span class='st'>"brightblue"</span>)
<span class='fu'>plot</span>(<span class='no'>fit6</span>)</div><img src='stan_glm-38.png' alt='' width='540' height='400' /><div class='input'><span class='fu'><a href='pp_check.stanreg.html'>pp_check</a></span>(<span class='no'>fit6</span>, <span class='kw'>plotfun</span> <span class='kw'>=</span> <span class='st'>"hist"</span>, <span class='kw'>nreps</span> <span class='kw'>=</span> <span class='fl'>5</span>)</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><img src='stan_glm-41.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># 80% interval of estimated reciprocal_dispersion parameter</span>
<span class='fu'><a href='posterior_interval.stanreg.html'>posterior_interval</a></span>(<span class='no'>fit6</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='st'>"reciprocal_dispersion"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.8</span>)</div><div class='output co'>#&gt;                            10%      90%
#&gt; reciprocal_dispersion 1.144819 1.701747</div><div class='input'><span class='fu'>plot</span>(<span class='no'>fit6</span>, <span class='st'>"areas"</span>, <span class='kw'>pars</span> <span class='kw'>=</span> <span class='st'>"reciprocal_dispersion"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.8</span>)</div><img src='stan_glm-45.png' alt='' width='540' height='400' /><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
